// MERGED SCRIPTS generated 09 April 2021 07:51

// -------------------------------------------------------
// MERGED: /scripts/moment.min.js

// moment.js
// version : 2.0.0
// author : Tim Wood
// license : MIT
// momentjs.com
(function(e){function O(e,t){return function(n){return j(e.call(this,n),t)}}function M(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function _(){}function D(e){H(this,e)}function P(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,u=e.minutes||e.minute||e.m||0,a=e.seconds||e.second||e.s||0,f=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=f+a*1e3+u*6e4+o*36e5,this._days=s+i*7,this._months=r+n*12,t.milliseconds=f%1e3,a+=B(f/1e3),t.seconds=a%60,u+=B(a/60),t.minutes=u%60,o+=B(u/60),t.hours=o%24,s+=B(o/24),s+=i*7,t.days=s%30,r+=B(s/30),t.months=r%12,n+=B(r/12),t.years=n}function H(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function B(e){return e<0?Math.ceil(e):Math.floor(e)}function j(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function F(e,t,n){var r=t._milliseconds,i=t._days,s=t._months,o;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function I(e){return Object.prototype.toString.call(e)==="[object Array]"}function q(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function R(e,t){return t.abbr=e,s[e]||(s[e]=new _),s[e].set(t),s[e]}function U(e){return e?(!s[e]&&o&&require("./lang/"+e),s[e]):t.fn._lang}function z(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t=e.match(a),n,r;for(n=0,r=t.length;n<r;n++)A[t[n]]?t[n]=A[t[n]]:t[n]=z(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=typeof t[n].call=="function"?t[n].call(i,e):t[n];return s}}function X(e,t){function r(t){return e.lang().longDateFormat(t)||t}var n=5;while(n--&&f.test(t))t=t.replace(f,r);return C[t]||(C[t]=W(t)),C[t](e)}function V(e){switch(e){case"DDDD":return p;case"YYYY":return d;case"YYYYY":return v;case"S":case"SS":case"SSS":case"DDD":return h;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return m;case"X":return b;case"Z":case"ZZ":return g;case"T":return y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return c;default:return new RegExp(e.replace("\\",""))}}function $(e,t,n){var r,i,s=n._a;switch(e){case"M":case"MM":s[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":r=U(n._l).monthsParse(t),r!=null?s[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm=(t+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,r=(t+"").match(x),r&&r[1]&&(n._tzh=~~r[1]),r&&r[2]&&(n._tzm=~~r[2]),r&&r[0]==="+"&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}t==null&&(n._isValid=!1)}function J(e){var t,n,r=[];if(e._d)return;for(t=0;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}function K(e){var t=e._f.match(a),n=e._i,r,i;e._a=[];for(r=0;r<t.length;r++)i=(V(t[r]).exec(n)||[])[0],i&&(n=n.slice(n.indexOf(i)+i.length)),A[t[r]]&&$(t[r],i,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&e._a[3]===12&&(e._a[3]=0),J(e)}function Q(e){var t,n,r,i=99,s,o,u;while(e._f.length){t=H({},e),t._f=e._f.pop(),K(t),n=new D(t);if(n.isValid()){r=n;break}u=q(t._a,n.toArray()),u<i&&(i=u,r=n)}H(e,r)}function G(e){var t,n=e._i;if(w.exec(n)){e._f="YYYY-MM-DDT";for(t=0;t<4;t++)if(S[t][1].exec(n)){e._f+=S[t][0];break}g.exec(n)&&(e._f+=" Z"),K(e)}else e._d=new Date(n)}function Y(t){var n=t._i,r=u.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?G(t):I(n)?(t._a=n.slice(0),J(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function Z(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function et(e,t,n){var i=r(Math.abs(e)/1e3),s=r(i/60),o=r(s/60),u=r(o/24),a=r(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",r(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,Z.apply({},f)}function tt(e,n,r){var i=r-n,s=r-e.day();return s>i&&(s-=7),s<i-7&&(s+=7),Math.ceil(t(e).add("d",s).dayOfYear()/7)}function nt(e){var n=e._i,r=e._f;return n===null||n===""?null:(typeof n=="string"&&(e._i=n=U().preparse(n)),t.isMoment(n)?(e=H({},n),e._d=new Date(+n._d)):r?I(r)?Q(e):K(e):Y(e),new D(e))}function rt(e,n){t.fn[e]=t.fn[e+"s"]=function(e){var t=this._isUTC?"UTC":"";return e!=null?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}function it(e){t.duration.fn[e]=function(){return this._data[e]}}function st(e,n){t.duration.fn["as"+e]=function(){return+this/n}}var t,n="2.0.0",r=Math.round,i,s={},o=typeof module!="undefined"&&module.exports,u=/^\/?Date\((\-?\d+)/i,a=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,f=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,l=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,c=/\d\d?/,h=/\d{1,3}/,p=/\d{3}/,d=/\d{1,4}/,v=/[+\-]?\d{1,6}/,m=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,g=/Z|[\+\-]\d\d:?\d\d/i,y=/T/i,b=/[\+\-]?\d+(\.\d{1,3})?/,w=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,E="YYYY-MM-DDTHH:mm:ssZ",S=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],x=/([\+\-]|\d\d)/gi,T="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),N={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},C={},k="DDD w W M D d".split(" "),L="M D H h m s w W".split(" "),A={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return j(this.year()%100,2)},YYYY:function(){return j(this.year(),4)},YYYYY:function(){return j(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return j(~~(this.milliseconds()/10),2)},SSS:function(){return j(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+j(~~(e/60),2)+":"+j(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+j(~~(10*e/6),4)},X:function(){return this.unix()}};while(k.length)i=k.pop(),A[i+"o"]=M(A[i]);while(L.length)i=L.pop(),A[i+i]=O(A[i],2);A.DDDD=O(A.DDD,3),_.prototype={set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var n,r,i,s;this._monthsParse||(this._monthsParse=[]);for(n=0;n<12;n++){this._monthsParse[n]||(r=t([2e3,n]),i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i"));if(this._monthsParse[n].test(e))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return tt(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},t=function(e,t,n){return nt({_i:e,_f:t,_l:n,_isUTC:!1})},t.utc=function(e,t,n){return nt({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=t.isDuration(e),i=typeof e=="number",s=r?e._data:i?{}:e,o;return i&&(n?s[n]=e:s.milliseconds=e),o=new P(s),r&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},t.version=n,t.defaultFormat=E,t.lang=function(e,n){var r;if(!e)return t.fn._lang._abbr;n?R(e,n):s[e]||U(e),t.duration.fn._lang=t.fn._lang=U(e)},t.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),U(e)},t.isMoment=function(e){return e instanceof D},t.isDuration=function(e){return e instanceof P},t.fn=D.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return t.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return this._isValid==null&&(this._a?this._isValid=!q(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var n=X(this,e||t.defaultFormat);return this.lang().postformat(n)},add:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),F(this,r,1),this},subtract:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),F(this,r,-1),this},diff:function(e,n,r){var i=this._isUTC?t(e).utc():t(e).local(),s=(this.zone()-i.zone())*6e4,o,u;return n&&(n=n.replace(/s$/,"")),n==="year"||n==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),u+=(this-t(this).startOf("month")-(i-t(i).startOf("month")))/o,n==="year"&&(u/=12)):(o=this-i-s,u=n==="second"?o/1e3:n==="minute"?o/6e4:n==="hour"?o/36e5:n==="day"?o/864e5:n==="week"?o/6048e5:o),r?u:B(u)},from:function(e,n){return t.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=this.diff(t().startOf("day"),"days",!0),n=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<t([this.year()]).zone()||this.zone()<t([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e==null?t:this.add({d:e-t})},startOf:function(e){e=e.replace(/s$/,"");switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)>+t(e).startOf(n)},isBefore:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)<+t(e).startOf(n)},isSame:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)===+t(e).startOf(n)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var n=r((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return e==null?n:this.add("d",e-n)},isoWeek:function(e){var t=tt(this,1,4);return e==null?t:this.add("d",(e-t)*7)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},lang:function(t){return t===e?this._lang:(this._lang=U(t),this)}};for(i=0;i<T.length;i++)rt(T[i].toLowerCase().replace(/s$/,""),T[i]);rt("year","FullYear"),t.fn.days=t.fn.day,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.duration.fn=P.prototype={weeks:function(){return B(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(e){var t=+this,n=et(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:t.fn.lang};for(i in N)N.hasOwnProperty(i)&&(st(i,N[i]),it(i.toLowerCase()));st("Weeks",6048e5),t.lang("en",{ordinal:function(e){var t=e%10,n=~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),o&&(module.exports=t),typeof ender=="undefined"&&(this.moment=t),typeof define=="function"&&define.amd&&define("moment",[],function(){return t})}).call(this);

// -------------------------------------------------------
// MERGED: /scripts/easyXDM.min.js

/**
 * easyXDM
 * http://easyxdm.net/
 * Copyright(c) 2009-2011, Øyvind Sean Kinsey, oyvind@kinsey.no.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(N,d,p,K,k,H){var b=this;var n=Math.floor(Math.random()*10000);var q=Function.prototype;var Q=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var R=/[\-\w]+\/\.\.\//;var F=/([^:])\/\//g;var I="";var o={};var M=N.easyXDM;var U="easyXDM_";var E;var y=false;var i;var h;function C(X,Z){var Y=typeof X[Z];return Y=="function"||(!!(Y=="object"&&X[Z]))||Y=="unknown"}function u(X,Y){return !!(typeof(X[Y])=="object"&&X[Y])}function r(X){return Object.prototype.toString.call(X)==="[object Array]"}function c(){try{var X=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i=Array.prototype.slice.call(X.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);h=parseInt(i[0],10)>9&&parseInt(i[1],10)>0;X=null;return true}catch(Y){return false}}var v,x;if(C(N,"addEventListener")){v=function(Z,X,Y){Z.addEventListener(X,Y,false)};x=function(Z,X,Y){Z.removeEventListener(X,Y,false)}}else{if(C(N,"attachEvent")){v=function(X,Z,Y){X.attachEvent("on"+Z,Y)};x=function(X,Z,Y){X.detachEvent("on"+Z,Y)}}else{throw new Error("Browser not supported")}}var W=false,J=[],L;if("readyState" in d){L=d.readyState;W=L=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(L=="loaded"||L=="interactive"))}else{W=!!d.body}function s(){if(W){return}W=true;for(var X=0;X<J.length;X++){J[X]()}J.length=0}if(!W){if(C(N,"addEventListener")){v(d,"DOMContentLoaded",s)}else{v(d,"readystatechange",function(){if(d.readyState=="complete"){s()}});if(d.documentElement.doScroll&&N===top){var g=function(){if(W){return}try{d.documentElement.doScroll("left")}catch(X){K(g,1);return}s()};g()}}v(N,"load",s)}function G(Y,X){if(W){Y.call(X);return}J.push(function(){Y.call(X)})}function m(){var Z=parent;if(I!==""){for(var X=0,Y=I.split(".");X<Y.length;X++){Z=Z[Y[X]]}}return Z.easyXDM}function e(X){N.easyXDM=M;I=X;if(I){U="easyXDM_"+I.replace(".","_")+"_"}return o}function z(X){return X.match(Q)[3]}function f(X){return X.match(Q)[4]||""}function j(Z){var X=Z.toLowerCase().match(Q);var aa=X[2],ab=X[3],Y=X[4]||"";if((aa=="http:"&&Y==":80")||(aa=="https:"&&Y==":443")){Y=""}return aa+"//"+ab+Y}function B(X){X=X.replace(F,"$1/");if(!X.match(/^(http||https):\/\//)){var Y=(X.substring(0,1)==="/")?"":p.pathname;if(Y.substring(Y.length-1)!=="/"){Y=Y.substring(0,Y.lastIndexOf("/")+1)}X=p.protocol+"//"+p.host+Y+X}while(R.test(X)){X=X.replace(R,"")}return X}function P(X,aa){var ac="",Z=X.indexOf("#");if(Z!==-1){ac=X.substring(Z);X=X.substring(0,Z)}var ab=[];for(var Y in aa){if(aa.hasOwnProperty(Y)){ab.push(Y+"="+H(aa[Y]))}}return X+(y?"#":(X.indexOf("?")==-1?"?":"&"))+ab.join("&")+ac}var S=(function(X){X=X.substring(1).split("&");var Z={},aa,Y=X.length;while(Y--){aa=X[Y].split("=");Z[aa[0]]=k(aa[1])}return Z}(/xdm_e=/.test(p.search)?p.search:p.hash));function t(X){return typeof X==="undefined"}var O=function(){var Y={};var Z={a:[1,2,3]},X='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(Z).replace((/\s/g),"")===X){return JSON}if(Object.toJSON){if(Object.toJSON(Z).replace((/\s/g),"")===X){Y.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){Z=X.evalJSON();if(Z.a&&Z.a.length===3&&Z.a[2]===3){Y.parse=function(aa){return aa.evalJSON()}}}if(Y.stringify&&Y.parse){O=function(){return Y};return Y}return null};function T(X,Y,Z){var ab;for(var aa in Y){if(Y.hasOwnProperty(aa)){if(aa in X){ab=Y[aa];if(typeof ab==="object"){T(X[aa],ab,Z)}else{if(!Z){X[aa]=Y[aa]}}}else{X[aa]=Y[aa]}}}return X}function a(){var Y=d.body.appendChild(d.createElement("form")),X=Y.appendChild(d.createElement("input"));X.name=U+"TEST"+n;E=X!==Y.elements[X.name];d.body.removeChild(Y)}function A(X){if(t(E)){a()}var Z;if(E){Z=d.createElement('<iframe name="'+X.props.name+'"/>')}else{Z=d.createElement("IFRAME");Z.name=X.props.name}Z.id=Z.name=X.props.name;delete X.props.name;if(X.onLoad){v(Z,"load",X.onLoad)}if(typeof X.container=="string"){X.container=d.getElementById(X.container)}if(!X.container){T(Z.style,{position:"absolute",top:"-2000px"});X.container=d.body}var Y=X.props.src;delete X.props.src;T(Z,X.props);Z.border=Z.frameBorder=0;Z.allowTransparency=true;X.container.appendChild(Z);Z.src=Y;X.props.src=Y;return Z}function V(aa,Z){if(typeof aa=="string"){aa=[aa]}var Y,X=aa.length;while(X--){Y=aa[X];Y=new RegExp(Y.substr(0,1)=="^"?Y:("^"+Y.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(Y.test(Z)){return true}}return false}function l(Z){var ae=Z.protocol,Y;Z.isHost=Z.isHost||t(S.xdm_p);y=Z.hash||false;if(!Z.props){Z.props={}}if(!Z.isHost){Z.channel=S.xdm_c;Z.secret=S.xdm_s;Z.remote=S.xdm_e;ae=S.xdm_p;if(Z.acl&&!V(Z.acl,Z.remote)){throw new Error("Access denied for "+Z.remote)}}else{Z.remote=B(Z.remote);Z.channel=Z.channel||"default"+n++;Z.secret=Math.random().toString(16).substring(2);if(t(ae)){if(j(p.href)==j(Z.remote)){ae="4"}else{if(C(N,"postMessage")||C(d,"postMessage")){ae="1"}else{if(Z.swf&&C(N,"ActiveXObject")&&c()){ae="6"}else{if(navigator.product==="Gecko"&&"frameElement" in N&&navigator.userAgent.indexOf("WebKit")==-1){ae="5"}else{if(Z.remoteHelper){Z.remoteHelper=B(Z.remoteHelper);ae="2"}else{ae="0"}}}}}}}Z.protocol=ae;switch(ae){case"0":T(Z,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(Z.isHost){if(!Z.local){var ac=p.protocol+"//"+p.host,X=d.body.getElementsByTagName("img"),ad;var aa=X.length;while(aa--){ad=X[aa];if(ad.src.substring(0,ac.length)===ac){Z.local=ad.src;break}}if(!Z.local){Z.local=N}}var ab={xdm_c:Z.channel,xdm_p:0};if(Z.local===N){Z.usePolling=true;Z.useParent=true;Z.local=p.protocol+"//"+p.host+p.pathname+p.search;ab.xdm_e=Z.local;ab.xdm_pa=1}else{ab.xdm_e=B(Z.local)}if(Z.container){Z.useResize=false;ab.xdm_po=1}Z.remote=P(Z.remote,ab)}else{T(Z,{channel:S.xdm_c,remote:S.xdm_e,useParent:!t(S.xdm_pa),usePolling:!t(S.xdm_po),useResize:Z.useParent?false:Z.useResize})}Y=[new o.stack.HashTransport(Z),new o.stack.ReliableBehavior({}),new o.stack.QueueBehavior({encode:true,maxLength:4000-Z.remote.length}),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"1":Y=[new o.stack.PostMessageTransport(Z)];break;case"2":Y=[new o.stack.NameTransport(Z),new o.stack.QueueBehavior(),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"3":Y=[new o.stack.NixTransport(Z)];break;case"4":Y=[new o.stack.SameOriginTransport(Z)];break;case"5":Y=[new o.stack.FrameElementTransport(Z)];break;case"6":if(!i){c()}Y=[new o.stack.FlashTransport(Z)];break}Y.push(new o.stack.QueueBehavior({lazy:Z.lazy,remove:true}));return Y}function D(aa){var ab,Z={incoming:function(ad,ac){this.up.incoming(ad,ac)},outgoing:function(ac,ad){this.down.outgoing(ac,ad)},callback:function(ac){this.up.callback(ac)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var Y=0,X=aa.length;Y<X;Y++){ab=aa[Y];T(ab,Z,true);if(Y!==0){ab.down=aa[Y-1]}if(Y!==X-1){ab.up=aa[Y+1]}}return ab}function w(X){X.up.down=X.down;X.down.up=X.up;X.up=X.down=null}T(o,{version:"2.4.15.118",query:S,stack:{},apply:T,getJSONObject:O,whenReady:G,noConflict:e});o.DomHelper={on:v,un:x,requiresJSON:function(X){if(!u(N,"JSON")){d.write('<script type="text/javascript" src="'+X+'"><\/script>')}}};(function(){var X={};o.Fn={set:function(Y,Z){X[Y]=Z},get:function(Z,Y){var aa=X[Z];if(Y){delete X[Z]}return aa}}}());o.Socket=function(Y){var X=D(l(Y).concat([{incoming:function(ab,aa){Y.onMessage(ab,aa)},callback:function(aa){if(Y.onReady){Y.onReady(aa)}}}])),Z=j(Y.remote);this.origin=j(Y.remote);this.destroy=function(){X.destroy()};this.postMessage=function(aa){X.outgoing(aa,Z)};X.init()};o.Rpc=function(Z,Y){if(Y.local){for(var ab in Y.local){if(Y.local.hasOwnProperty(ab)){var aa=Y.local[ab];if(typeof aa==="function"){Y.local[ab]={method:aa}}}}}var X=D(l(Z).concat([new o.stack.RpcBehavior(this,Y),{callback:function(ac){if(Z.onReady){Z.onReady(ac)}}}]));this.origin=j(Z.remote);this.destroy=function(){X.destroy()};X.init()};o.stack.SameOriginTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa(ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:p.protocol+"//"+p.host+p.pathname,xdm_c:Y.channel,xdm_p:4}),name:U+Y.channel+"_provider"});ab=A(Y);o.Fn.set(Y.channel,function(ac){aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}})}else{aa=m().Fn.get(Y.channel,true)(function(ac){Z.up.incoming(ac,X)});K(function(){Z.up.callback(true)},0)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.FlashTransport=function(aa){var ac,X,ab,ad,Y,ae;function af(ah,ag){K(function(){ac.up.incoming(ah,ad)},0)}function Z(ah){var ag=aa.swf+"?host="+aa.isHost;var aj="easyXDM_swf_"+Math.floor(Math.random()*10000);o.Fn.set("flash_loaded"+ah.replace(/[\-.]/g,"_"),function(){o.stack.FlashTransport[ah].swf=Y=ae.firstChild;var ak=o.stack.FlashTransport[ah].queue;for(var al=0;al<ak.length;al++){ak[al]()}ak.length=0});if(aa.swfContainer){ae=(typeof aa.swfContainer=="string")?d.getElementById(aa.swfContainer):aa.swfContainer}else{ae=d.createElement("div");T(ae.style,h&&aa.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});d.body.appendChild(ae)}var ai="callback=flash_loaded"+ah.replace(/[\-.]/g,"_")+"&proto="+b.location.protocol+"&domain="+z(b.location.href)+"&port="+f(b.location.href)+"&ns="+I;ae.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+aj+"' data='"+ag+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+ag+"'></param><param name='flashvars' value='"+ai+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+ai+"' allowScriptAccess='always' wmode='transparent' src='"+ag+"' height='1' width='1'></embed></object>"}return(ac={outgoing:function(ah,ai,ag){Y.postMessage(aa.channel,ah.toString());if(ag){ag()}},destroy:function(){try{Y.destroyChannel(aa.channel)}catch(ag){}Y=null;if(X){X.parentNode.removeChild(X);X=null}},onDOMReady:function(){ad=aa.remote;o.Fn.set("flash_"+aa.channel+"_init",function(){K(function(){ac.up.callback(true)})});o.Fn.set("flash_"+aa.channel+"_onMessage",af);aa.swf=B(aa.swf);var ah=z(aa.swf);var ag=function(){o.stack.FlashTransport[ah].init=true;Y=o.stack.FlashTransport[ah].swf;Y.createChannel(aa.channel,aa.secret,j(aa.remote),aa.isHost);if(aa.isHost){if(h&&aa.swfNoThrottle){T(aa.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})}T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:6,xdm_s:aa.secret}),name:U+aa.channel+"_provider"});X=A(aa)}};if(o.stack.FlashTransport[ah]&&o.stack.FlashTransport[ah].init){ag()}else{if(!o.stack.FlashTransport[ah]){o.stack.FlashTransport[ah]={queue:[ag]};Z(ah)}else{o.stack.FlashTransport[ah].queue.push(ag)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.PostMessageTransport=function(aa){var ac,ad,Y,Z;function X(ae){if(ae.origin){return j(ae.origin)}if(ae.uri){return j(ae.uri)}if(ae.domain){return p.protocol+"//"+ae.domain}throw"Unable to retrieve the origin of the event"}function ab(af){var ae=X(af);if(ae==Z&&af.data.substring(0,aa.channel.length+1)==aa.channel+" "){ac.up.incoming(af.data.substring(aa.channel.length+1),ae)}}return(ac={outgoing:function(af,ag,ae){Y.postMessage(aa.channel+" "+af,ag||Z);if(ae){ae()}},destroy:function(){x(N,"message",ab);if(ad){Y=null;ad.parentNode.removeChild(ad);ad=null}},onDOMReady:function(){Z=j(aa.remote);if(aa.isHost){var ae=function(af){if(af.data==aa.channel+"-ready"){Y=("postMessage" in ad.contentWindow)?ad.contentWindow:ad.contentWindow.document;x(N,"message",ae);v(N,"message",ab);K(function(){ac.up.callback(true)},0)}};v(N,"message",ae);T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:1}),name:U+aa.channel+"_provider"});ad=A(aa)}else{v(N,"message",ab);Y=("postMessage" in N.parent)?N.parent:N.parent.document;Y.postMessage(aa.channel+"-ready",Z);K(function(){ac.up.callback(true)},0)}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.FrameElementTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa.call(this,ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:j(p.href),xdm_c:Y.channel,xdm_p:5}),name:U+Y.channel+"_provider"});ab=A(Y);ab.fn=function(ac){delete ab.fn;aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}}}else{if(d.referrer&&j(d.referrer)!=S.xdm_e){N.top.location=S.xdm_e}aa=N.frameElement.fn(function(ac){Z.up.incoming(ac,X)});Z.up.callback(true)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.NameTransport=function(ab){var ac;var ae,ai,aa,ag,ah,Y,X;function af(al){var ak=ab.remoteHelper+(ae?"#_3":"#_2")+ab.channel;ai.contentWindow.sendMessage(al,ak)}function ad(){if(ae){if(++ag===2||!ae){ac.up.callback(true)}}else{af("ready");ac.up.callback(true)}}function aj(ak){ac.up.incoming(ak,Y)}function Z(){if(ah){K(function(){ah(true)},0)}}return(ac={outgoing:function(al,am,ak){ah=ak;af(al)},destroy:function(){ai.parentNode.removeChild(ai);ai=null;if(ae){aa.parentNode.removeChild(aa);aa=null}},onDOMReady:function(){ae=ab.isHost;ag=0;Y=j(ab.remote);ab.local=B(ab.local);if(ae){o.Fn.set(ab.channel,function(al){if(ae&&al==="ready"){o.Fn.set(ab.channel,aj);ad()}});X=P(ab.remote,{xdm_e:ab.local,xdm_c:ab.channel,xdm_p:2});T(ab.props,{src:X+"#"+ab.channel,name:U+ab.channel+"_provider"});aa=A(ab)}else{ab.remoteHelper=ab.remote;o.Fn.set(ab.channel,aj)}ai=A({props:{src:ab.local+"#_4"+ab.channel},onLoad:function ak(){var al=ai||this;x(al,"load",ak);o.Fn.set(ab.channel+"_load",Z);(function am(){if(typeof al.contentWindow.sendMessage=="function"){ad()}else{K(am,50)}}())}})},init:function(){G(ac.onDOMReady,ac)}})};o.stack.HashTransport=function(Z){var ac;var ah=this,af,aa,X,ad,am,ab,al;var ag,Y;function ak(ao){if(!al){return}var an=Z.remote+"#"+(am++)+"_"+ao;((af||!ag)?al.contentWindow:al).location=an}function ae(an){ad=an;ac.up.incoming(ad.substring(ad.indexOf("_")+1),Y)}function aj(){if(!ab){return}var an=ab.location.href,ap="",ao=an.indexOf("#");if(ao!=-1){ap=an.substring(ao)}if(ap&&ap!=ad){ae(ap)}}function ai(){aa=setInterval(aj,X)}return(ac={outgoing:function(an,ao){ak(an)},destroy:function(){N.clearInterval(aa);if(af||!ag){al.parentNode.removeChild(al)}al=null},onDOMReady:function(){af=Z.isHost;X=Z.interval;ad="#"+Z.channel;am=0;ag=Z.useParent;Y=j(Z.remote);if(af){Z.props={src:Z.remote,name:U+Z.channel+"_provider"};if(ag){Z.onLoad=function(){ab=N;ai();ac.up.callback(true)}}else{var ap=0,an=Z.delay/50;(function ao(){if(++ap>an){throw new Error("Unable to reference listenerwindow")}try{ab=al.contentWindow.frames[U+Z.channel+"_consumer"]}catch(aq){}if(ab){ai();ac.up.callback(true)}else{K(ao,50)}}())}al=A(Z)}else{ab=N;ai();if(ag){al=parent;ac.up.callback(true)}else{T(Z,{props:{src:Z.remote+"#"+Z.channel+new Date(),name:U+Z.channel+"_consumer"},onLoad:function(){ac.up.callback(true)}});al=A(Z)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.ReliableBehavior=function(Y){var aa,ac;var ab=0,X=0,Z="";return(aa={incoming:function(af,ad){var ae=af.indexOf("_"),ag=af.substring(0,ae).split(",");af=af.substring(ae+1);if(ag[0]==ab){Z="";if(ac){ac(true)}}if(af.length>0){aa.down.outgoing(ag[1]+","+ab+"_"+Z,ad);if(X!=ag[1]){X=ag[1];aa.up.incoming(af,ad)}}},outgoing:function(af,ad,ae){Z=af;ac=ae;aa.down.outgoing(X+","+(++ab)+"_"+af,ad)}})};o.stack.QueueBehavior=function(Z){var ac,ad=[],ag=true,aa="",af,X=0,Y=false,ab=false;function ae(){if(Z.remove&&ad.length===0){w(ac);return}if(ag||ad.length===0||af){return}ag=true;var ah=ad.shift();ac.down.outgoing(ah.data,ah.origin,function(ai){ag=false;if(ah.callback){K(function(){ah.callback(ai)},0)}ae()})}return(ac={init:function(){if(t(Z)){Z={}}if(Z.maxLength){X=Z.maxLength;ab=true}if(Z.lazy){Y=true}else{ac.down.init()}},callback:function(ai){ag=false;var ah=ac.up;ae();ah.callback(ai)},incoming:function(ak,ai){if(ab){var aj=ak.indexOf("_"),ah=parseInt(ak.substring(0,aj),10);aa+=ak.substring(aj+1);if(ah===0){if(Z.encode){aa=k(aa)}ac.up.incoming(aa,ai);aa=""}}else{ac.up.incoming(ak,ai)}},outgoing:function(al,ai,ak){if(Z.encode){al=H(al)}var ah=[],aj;if(ab){while(al.length!==0){aj=al.substring(0,X);al=al.substring(aj.length);ah.push(aj)}while((aj=ah.shift())){ad.push({data:ah.length+"_"+aj,origin:ai,callback:ah.length===0?ak:null})}}else{ad.push({data:al,origin:ai,callback:ak})}if(Y){ac.down.init()}else{ae()}},destroy:function(){af=true;ac.down.destroy()}})};o.stack.VerifyBehavior=function(ab){var ac,aa,Y,Z=false;function X(){aa=Math.random().toString(16).substring(2);ac.down.outgoing(aa)}return(ac={incoming:function(af,ad){var ae=af.indexOf("_");if(ae===-1){if(af===aa){ac.up.callback(true)}else{if(!Y){Y=af;if(!ab.initiate){X()}ac.down.outgoing(af)}}}else{if(af.substring(0,ae)===Y){ac.up.incoming(af.substring(ae+1),ad)}}},outgoing:function(af,ad,ae){ac.down.outgoing(aa+"_"+af,ad,ae)},callback:function(ad){if(ab.initiate){X()}}})};o.stack.RpcBehavior=function(ad,Y){var aa,af=Y.serializer||O();var ae=0,ac={};function X(ag){ag.jsonrpc="2.0";aa.down.outgoing(af.stringify(ag))}function ab(ag,ai){var ah=Array.prototype.slice;return function(){var aj=arguments.length,al,ak={method:ai};if(aj>0&&typeof arguments[aj-1]==="function"){if(aj>1&&typeof arguments[aj-2]==="function"){al={success:arguments[aj-2],error:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-2)}else{al={success:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-1)}ac[""+(++ae)]=al;ak.id=ae}else{ak.params=ah.call(arguments,0)}if(ag.namedParams&&ak.params.length===1){ak.params=ak.params[0]}X(ak)}}function Z(an,am,ai,al){if(!ai){if(am){X({id:am,error:{code:-32601,message:"Procedure not found."}})}return}var ak,ah;if(am){ak=function(ao){ak=q;X({id:am,result:ao})};ah=function(ao,ap){ah=q;var aq={id:am,error:{code:-32099,message:ao}};if(ap){aq.error.data=ap}X(aq)}}else{ak=ah=q}if(!r(al)){al=[al]}try{var ag=ai.method.apply(ai.scope,al.concat([ak,ah]));if(!t(ag)){ak(ag)}}catch(aj){ah(aj.message)}}return(aa={incoming:function(ah,ag){var ai=af.parse(ah);if(ai.method){if(Y.handle){Y.handle(ai,X)}else{Z(ai.method,ai.id,Y.local[ai.method],ai.params)}}else{var aj=ac[ai.id];if(ai.error){if(aj.error){aj.error(ai.error)}}else{if(aj.success){aj.success(ai.result)}}delete ac[ai.id]}},init:function(){if(Y.remote){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)){ad[ag]=ab(Y.remote[ag],ag)}}}aa.down.init()},destroy:function(){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)&&ad.hasOwnProperty(ag)){delete ad[ag]}}aa.down.destroy()}})};b.easyXDM=o})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);

// -------------------------------------------------------
// MERGED: /scripts/iscroll.min.js

(function(h,w){function r(b){if(""===n)return b;b=b.charAt(0).toUpperCase()+b.substr(1);return n+b}var f=Math,B=w.createElement("div").style,n;a:{for(var p=["t","webkitT","MozT","msT","OT"],G,x=0,L=p.length;x<L;x++)if(G=p[x]+"ransform",G in B){n=p[x].substr(0,p[x].length-1);break a}n=!1}var j=n?"-"+n.toLowerCase()+"-":"",q=r("transform"),M=r("transitionProperty"),t=r("transitionDuration"),N=r("transformOrigin"),O=r("transitionTimingFunction"),C=r("transitionDelay"),D=/android/gi.test(navigator.appVersion),
H=/iphone|ipad/gi.test(navigator.appVersion),p=/hp-tablet/gi.test(navigator.appVersion),I=r("perspective")in B,m="ontouchstart"in h&&!p,J=!1!==n,P=r("transition")in B,E="onorientationchange"in h?"orientationchange":"resize",F=m?"touchstart":"mousedown",y=m?"touchmove":"mousemove",z=m?"touchend":"mouseup",A=m?"touchcancel":"mouseup",u;u=!1===n?!1:{"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"}[n];var Q=h.requestAnimationFrame||h.webkitRequestAnimationFrame||
h.mozRequestAnimationFrame||h.oRequestAnimationFrame||h.msRequestAnimationFrame||function(b){return setTimeout(b,1)},K=h.cancelRequestAnimationFrame||h.webkitCancelAnimationFrame||h.webkitCancelRequestAnimationFrame||h.mozCancelRequestAnimationFrame||h.oCancelRequestAnimationFrame||h.msCancelRequestAnimationFrame||clearTimeout,s=I?" translateZ(0)":"",p=function(b,a){var c=this,d;c.wrapper="object"==typeof b?b:w.getElementById(b);c.wrapper.style.overflow="hidden";c.scroller=c.wrapper.children[0];c.options=
{hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:D,hideScrollbar:H,fadeScrollbar:H&&I,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,
onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(d in a)c.options[d]=a[d];c.x=c.options.x;c.y=c.options.y;c.options.useTransform=J&&c.options.useTransform;c.options.hScrollbar=c.options.hScroll&&c.options.hScrollbar;c.options.vScrollbar=c.options.vScroll&&c.options.vScrollbar;c.options.zoom=c.options.useTransform&&c.options.zoom;c.options.useTransition=P&&c.options.useTransition;c.options.zoom&&D&&(s="");c.scroller.style[M]=c.options.useTransform?j+
"transform":"top left";c.scroller.style[t]="0";c.scroller.style[N]="0 0";c.options.useTransition&&(c.scroller.style[O]="cubic-bezier(0.33,0.66,0.66,1)");c.options.useTransform?c.scroller.style[q]="translate("+c.x+"px,"+c.y+"px)"+s:c.scroller.style.cssText+=";position:absolute;top:"+c.y+"px;left:"+c.x+"px";c.options.useTransition&&(c.options.fixedScrollbar=!0);c.refresh();c._bind(E,h);c._bind(F);!m&&"none"!=c.options.wheelAction&&(c._bind("DOMMouseScroll"),c._bind("mousewheel"));c.options.checkDOMChanges&&
(c.checkDOMTime=setInterval(function(){c._checkDOMChanges()},500))};p.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(b){console.log(b);switch(b.type){case F:if(!m&&0!==b.button)break;this._start(b);break;case y:this._move(b);break;case z:case A:this._end(b);break;case E:this._resize();break;case "DOMMouseScroll":case "mousewheel":this._wheel(b);break;case u:this._transitionEnd(b)}},_checkDOMChanges:function(){!this.moved&&
(!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale))&&this.refresh()},_scrollbar:function(b){var a;this[b+"Scrollbar"]?(this[b+"ScrollbarWrapper"]||(a=w.createElement("div"),this.options.scrollbarClass?a.className=this.options.scrollbarClass+b.toUpperCase():a.style.cssText="position:absolute;z-index:100;"+("h"==b?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?
"7":"2")+"px;top:2px;right:1px"),a.style.cssText+=";pointer-events:none;"+j+"transition-property:opacity;"+j+"transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(a),this[b+"ScrollbarWrapper"]=a,a=w.createElement("div"),this.options.scrollbarClass||(a.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+j+"background-clip:padding-box;"+j+"box-sizing:border-box;"+
("h"==b?"height:100%":"width:100%")+";"+j+"border-radius:3px;border-radius:3px"),a.style.cssText+=";pointer-events:none;"+j+"transition-property:"+j+"transform;"+j+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+j+"transition-duration:0;"+j+"transform: translate(0,0)"+s,this.options.useTransition&&(a.style.cssText+=";"+j+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[b+"ScrollbarWrapper"].appendChild(a),this[b+"ScrollbarIndicator"]=a),"h"==b?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,
this.hScrollbarIndicatorSize=f.max(f.round(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW),8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=f.max(f.round(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH),8),this.vScrollbarIndicator.style.height=
this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(b,!0)):this[b+"ScrollbarWrapper"]&&(J&&(this[b+"ScrollbarIndicator"].style[q]=""),this[b+"ScrollbarWrapper"].parentNode.removeChild(this[b+"ScrollbarWrapper"]),this[b+"ScrollbarWrapper"]=null,this[b+"ScrollbarIndicator"]=null)},_resize:function(){var b=this;setTimeout(function(){b.refresh()},D?200:0)},_pos:function(b,
a){this.zoomed||(b=this.hScroll?b:0,a=this.vScroll?a:0,this.options.useTransform?this.scroller.style[q]="translate("+b+"px,"+a+"px) scale("+this.scale+")"+s:(b=f.round(b),a=f.round(a),this.scroller.style.left=b+"px",this.scroller.style.top=a+"px"),this.x=b,this.y=a,this._scrollbarPos("h"),this._scrollbarPos("v"))},_scrollbarPos:function(b,a){var c="h"==b?this.x:this.y;this[b+"Scrollbar"]&&(c*=this[b+"ScrollbarProp"],0>c?(this.options.fixedScrollbar||(c=this[b+"ScrollbarIndicatorSize"]+f.round(3*c),
8>c&&(c=8),this[b+"ScrollbarIndicator"].style["h"==b?"width":"height"]=c+"px"),c=0):c>this[b+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?c=this[b+"ScrollbarMaxScroll"]:(c=this[b+"ScrollbarIndicatorSize"]-f.round(3*(c-this[b+"ScrollbarMaxScroll"])),8>c&&(c=8),this[b+"ScrollbarIndicator"].style["h"==b?"width":"height"]=c+"px",c=this[b+"ScrollbarMaxScroll"]+(this[b+"ScrollbarIndicatorSize"]-c))),this[b+"ScrollbarWrapper"].style[C]="0",this[b+"ScrollbarWrapper"].style.opacity=a&&this.options.hideScrollbar?
"0":"1",this[b+"ScrollbarIndicator"].style[q]="translate("+("h"==b?c+"px,0)":"0,"+c+"px)")+s)},_start:function(b){var a=m?b.touches[0]:b,c,d;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,b);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&(m&&1<b.touches.length)&&(d=f.abs(b.touches[0].pageX-b.touches[1].pageX),
c=f.abs(b.touches[0].pageY-b.touches[1].pageY),this.touchesDistStart=f.sqrt(d*d+c*c),this.originX=f.abs(b.touches[0].pageX+b.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=f.abs(b.touches[0].pageY+b.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,b));if(this.options.momentum&&(this.options.useTransform?(c=getComputedStyle(this.scroller,null)[q].replace(/[^0-9\-.,]/g,"").split(","),d=+(c[12]||c[4]),c=+(c[13]||c[5])):
(d=+getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),c=+getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),d!=this.x||c!=this.y))this.options.useTransition?this._unbind(u):K(this.aniTime),this.steps=[],this._pos(d,c),this.options.onScrollEnd&&this.options.onScrollEnd.call(this);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=a.pageX;this.pointY=a.pageY;this.startTime=b.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,
b);this._bind(y,h);this._bind(z,h);this._bind(A,h)}},_move:function(b){console.log("test");var a=m?b.touches[0]:b,c=a.pageX-this.pointX,d=a.pageY-this.pointY,e=this.x+c,g=this.y+d,h=b.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,b);if(this.options.zoom&&m&&1<b.touches.length)e=f.abs(b.touches[0].pageX-b.touches[1].pageX),g=f.abs(b.touches[0].pageY-b.touches[1].pageY),this.touchesDist=f.sqrt(e*e+g*g),this.zoomed=!0,a=1/this.touchesDistStart*this.touchesDist*
this.scale,a<this.options.zoomMin?a=0.5*this.options.zoomMin*Math.pow(2,a/this.options.zoomMin):a>this.options.zoomMax&&(a=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/a)),this.lastScale=a/this.scale,e=this.originX-this.originX*this.lastScale+this.x,g=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[q]="translate("+e+"px,"+g+"px) scale("+a+")"+s,this.options.onZoom&&this.options.onZoom.call(this,b);else{this.pointX=a.pageX;this.pointY=a.pageY;if(0<e||e<this.maxScrollX)e=
this.options.bounce?this.x+c/2:0<=e||0<=this.maxScrollX?0:this.maxScrollX;if(g>this.minScrollY||g<this.maxScrollY)g=this.options.bounce?this.y+d/2:g>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=c;this.distY+=d;this.absDistX=f.abs(this.distX);this.absDistY=f.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(g=this.y,d=0):this.absDistY>this.absDistX+5&&(e=this.x,c=0)),this.moved=!0,this._pos(e,g),this.dirX=
0<c?-1:0>c?1:0,this.dirY=0<d?-1:0>d?1:0,300<h-this.startTime&&(this.startTime=h,this.startX=this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,b))}},_end:function(b){if(!(m&&0!==b.touches.length)){var a=this,c=m?b.changedTouches[0]:b,d,e,g={dist:0,time:0},k={dist:0,time:0},v=(b.timeStamp||Date.now())-a.startTime,l=a.x,j=a.y;a._unbind(y,h);a._unbind(z,h);a._unbind(A,h);a.options.onBeforeScrollEnd&&a.options.onBeforeScrollEnd.call(a,b);if(a.zoomed)l=a.scale*a.lastScale,
l=Math.max(a.options.zoomMin,l),l=Math.min(a.options.zoomMax,l),a.lastScale=l/a.scale,a.scale=l,a.x=a.originX-a.originX*a.lastScale+a.x,a.y=a.originY-a.originY*a.lastScale+a.y,a.scroller.style[t]="200ms",a.scroller.style[q]="translate("+a.x+"px,"+a.y+"px) scale("+a.scale+")"+s,a.zoomed=!1,a.refresh(),a.options.onZoomEnd&&a.options.onZoomEnd.call(a,b);else{if(a.moved){if(300>v&&a.options.momentum){g=l?a._momentum(l-a.startX,v,-a.x,a.scrollerW-a.wrapperW+a.x,a.options.bounce?a.wrapperW:0):g;k=j?a._momentum(j-
a.startY,v,-a.y,0>a.maxScrollY?a.scrollerH-a.wrapperH+a.y-a.minScrollY:0,a.options.bounce?a.wrapperH:0):k;l=a.x+g.dist;j=a.y+k.dist;if(0<a.x&&0<l||a.x<a.maxScrollX&&l<a.maxScrollX)g={dist:0,time:0};if(a.y>a.minScrollY&&j>a.minScrollY||a.y<a.maxScrollY&&j<a.maxScrollY)k={dist:0,time:0}}g.dist||k.dist?(g=f.max(f.max(g.time,k.time),10),a.options.snap&&(k=l-a.absStartX,v=j-a.absStartY,f.abs(k)<a.options.snapThreshold&&f.abs(v)<a.options.snapThreshold?a.scrollTo(a.absStartX,a.absStartY,200):(k=a._snap(l,
j),l=k.x,j=k.y,g=f.max(k.time,g))),a.scrollTo(f.round(l),f.round(j),g)):a.options.snap?(k=l-a.absStartX,v=j-a.absStartY,f.abs(k)<a.options.snapThreshold&&f.abs(v)<a.options.snapThreshold?a.scrollTo(a.absStartX,a.absStartY,200):(k=a._snap(a.x,a.y),(k.x!=a.x||k.y!=a.y)&&a.scrollTo(k.x,k.y,k.time))):a._resetPos(200)}else m&&(a.doubleTapTimer&&a.options.zoom?(clearTimeout(a.doubleTapTimer),a.doubleTapTimer=null,a.options.onZoomStart&&a.options.onZoomStart.call(a,b),a.zoom(a.pointX,a.pointY,1==a.scale?
a.options.doubleTapZoom:1),a.options.onZoomEnd&&setTimeout(function(){a.options.onZoomEnd.call(a,b)},200)):this.options.handleClick&&(a.doubleTapTimer=setTimeout(function(){a.doubleTapTimer=null;for(d=c.target;1!=d.nodeType;)d=d.parentNode;"SELECT"!=d.tagName&&("INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName)&&(e=w.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,b.view,1,c.screenX,c.screenY,c.clientX,c.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,null),e._fake=!0,d.dispatchEvent(e))},a.options.zoom?
250:0))),a._resetPos(400);a.options.onTouchEnd&&a.options.onTouchEnd.call(a,b)}}},_resetPos:function(b){var a=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,c=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;a==this.x&&c==this.y?(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==n&&(this.hScrollbarWrapper.style[C]="300ms"),this.hScrollbarWrapper.style.opacity=
"0"),this.vScrollbar&&this.options.hideScrollbar&&("webkit"==n&&(this.vScrollbarWrapper.style[C]="300ms"),this.vScrollbarWrapper.style.opacity="0")):this.scrollTo(a,c,b||0)},_wheel:function(b){var a=this,c,d;if("wheelDeltaX"in b)c=b.wheelDeltaX/12,d=b.wheelDeltaY/12;else if("wheelDelta"in b)c=d=b.wheelDelta/12;else if("detail"in b)c=d=3*-b.detail;else return;"zoom"==a.options.wheelAction?(d=a.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),d<a.options.zoomMin&&(d=a.options.zoomMin),d>a.options.zoomMax&&
(d=a.options.zoomMax),d!=a.scale&&(!a.wheelZoomCount&&a.options.onZoomStart&&a.options.onZoomStart.call(a,b),a.wheelZoomCount++,a.zoom(b.pageX,b.pageY,d,400),setTimeout(function(){a.wheelZoomCount--;!a.wheelZoomCount&&a.options.onZoomEnd&&a.options.onZoomEnd.call(a,b)},400))):(c=a.x+c,d=a.y+d,0<c?c=0:c<a.maxScrollX&&(c=a.maxScrollX),d>a.minScrollY?d=a.minScrollY:d<a.maxScrollY&&(d=a.maxScrollY),0>a.maxScrollY&&a.scrollTo(c,d,0))},_transitionEnd:function(b){b.target==this.scroller&&(this._unbind(u),
this._startAni())},_startAni:function(){var b=this,a=b.x,c=b.y,d=(new Date).getTime(),e,g,h;b.animating||(b.steps.length?(e=b.steps.shift(),e.x==a&&e.y==c&&(e.time=0),b.animating=!0,b.moved=!0,b.options.useTransition?(b._transitionTime(e.time),b._pos(e.x,e.y),b.animating=!1,e.time?b._bind(u):b._resetPos(0)):(h=function(){var j=(new Date).getTime(),l;j>=d+e.time?(b._pos(e.x,e.y),b.animating=!1,b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b),b._startAni()):(j=(j-d)/e.time-1,g=f.sqrt(1-j*
j),j=(e.x-a)*g+a,l=(e.y-c)*g+c,b._pos(j,l),b.animating&&(b.aniTime=Q(h)))},h())):b._resetPos(400))},_transitionTime:function(b){b+="ms";this.scroller.style[t]=b;this.hScrollbar&&(this.hScrollbarIndicator.style[t]=b);this.vScrollbar&&(this.vScrollbarIndicator.style[t]=b)},_momentum:function(b,a,c,d,e){a=f.abs(b)/a;var g=a*a/0.0012;0<b&&g>c?(c+=e/(6/(6E-4*(g/a))),a=a*c/g,g=c):0>b&&g>d&&(d+=e/(6/(6E-4*(g/a))),a=a*d/g,g=d);return{dist:g*(0>b?-1:1),time:f.round(a/6E-4)}},_offset:function(b){for(var a=
-b.offsetLeft,c=-b.offsetTop;b=b.offsetParent;)a-=b.offsetLeft,c-=b.offsetTop;b!=this.wrapper&&(a*=this.scale,c*=this.scale);return{left:a,top:c}},_snap:function(b,a){var c,d,e;e=this.pagesX.length-1;c=0;for(d=this.pagesX.length;c<d;c++)if(b>=this.pagesX[c]){e=c;break}e==this.currPageX&&(0<e&&0>this.dirX)&&e--;b=this.pagesX[e];d=(d=f.abs(b-this.pagesX[this.currPageX]))?500*(f.abs(this.x-b)/d):0;this.currPageX=e;e=this.pagesY.length-1;for(c=0;c<e;c++)if(a>=this.pagesY[c]){e=c;break}e==this.currPageY&&
(0<e&&0>this.dirY)&&e--;a=this.pagesY[e];c=(c=f.abs(a-this.pagesY[this.currPageY]))?500*(f.abs(this.y-a)/c):0;this.currPageY=e;e=f.round(f.max(d,c))||200;return{x:b,y:a,time:e}},_bind:function(b,a,c){document.addEventListener?(a||this.scroller).addEventListener(b,this,!!c):(a||this.scroller).attachEvent(b,this)},_unbind:function(b,a,c){document.removeEventListener?(a||this.scroller).removeEventListener(b,this,!!c):(a||this.scroller).detachEvent(b,this)},destroy:function(){this.scroller.style[q]="";
this.vScrollbar=this.hScrollbar=!1;this._scrollbar("h");this._scrollbar("v");this._unbind(E,h);this._unbind(F);this._unbind(y,h);this._unbind(z,h);this._unbind(A,h);this.options.hasTouch||(this._unbind("DOMMouseScroll"),this._unbind("mousewheel"));this.options.useTransition&&this._unbind(u);this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var b,a,c,d=0;a=0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);
this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=f.round(this.scroller.offsetWidth*this.scale);this.scrollerH=f.round((this.scroller.offsetHeight+this.minScrollY)*this.scale);this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);this.hScroll=this.options.hScroll&&0>this.maxScrollX;
this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;b=this._offset(this.wrapper);this.wrapperOffsetLeft=-b.left;this.wrapperOffsetTop=-b.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];c=this.scroller.querySelectorAll(this.options.snap);b=0;for(a=c.length;b<a;b++)d=this._offset(c[b]),
d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,this.pagesX[b]=d.left<this.maxScrollX?this.maxScrollX:d.left*this.scale,this.pagesY[b]=d.top<this.maxScrollY?this.maxScrollY:d.top*this.scale}else if(this.options.snap){for(this.pagesX=[];d>=this.maxScrollX;)this.pagesX[a]=d,d-=this.wrapperW,a++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);a=d=0;for(this.pagesY=[];d>=this.maxScrollY;)this.pagesY[a]=
d,d-=this.wrapperH,a++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[t]="0",this._resetPos(400))},scrollTo:function(b,a,c,d){var e=b;this.stop();e.length||(e=[{x:b,y:a,time:c,relative:d}]);b=0;for(a=e.length;b<a;b++)e[b].relative&&(e[b].x=this.x-e[b].x,e[b].y=this.y-e[b].y),this.steps.push({x:e[b].x,y:e[b].y,time:e[b].time||
0});this._startAni()},scrollToElement:function(b,a){var c;if(b=b.nodeType?b:this.scroller.querySelector(b))c=this._offset(b),c.left+=this.wrapperOffsetLeft,c.top+=this.wrapperOffsetTop,c.left=0<c.left?0:c.left<this.maxScrollX?this.maxScrollX:c.left,c.top=c.top>this.minScrollY?this.minScrollY:c.top<this.maxScrollY?this.maxScrollY:c.top,a=void 0===a?f.max(2*f.abs(c.left),2*f.abs(c.top)):a,this.scrollTo(c.left,c.top,a)},scrollToPage:function(b,a,c){c=void 0===c?400:c;this.options.onScrollStart&&this.options.onScrollStart.call(this);
this.options.snap?(b="next"==b?this.currPageX+1:"prev"==b?this.currPageX-1:b,a="next"==a?this.currPageY+1:"prev"==a?this.currPageY-1:a,b=0>b?0:b>this.pagesX.length-1?this.pagesX.length-1:b,a=0>a?0:a>this.pagesY.length-1?this.pagesY.length-1:a,this.currPageX=b,this.currPageY=a,b=this.pagesX[b],a=this.pagesY[a]):(b*=-this.wrapperW,a*=-this.wrapperH,b<this.maxScrollX&&(b=this.maxScrollX),a<this.maxScrollY&&(a=this.maxScrollY));this.scrollTo(b,a,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=
!1;this._unbind(y,h);this._unbind(z,h);this._unbind(A,h)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(u):K(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(b,a,c,d){var e=c/this.scale;this.options.useTransform&&(this.zoomed=!0,d=void 0===d?200:d,b=b-this.wrapperOffsetLeft-this.x,a=a-this.wrapperOffsetTop-this.y,this.x=b-b*e+this.x,this.y=a-a*e+this.y,this.scale=c,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:
this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[t]=d+"ms",this.scroller.style[q]="translate("+this.x+"px,"+this.y+"px) scale("+c+")"+s,this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};B=null;"undefined"!==typeof exports?exports.iScroll=p:h.iScroll=p})(window,document);


// -------------------------------------------------------
// MERGED: /scripts/jquery.address-1.5.min.js

/*
 * jQuery Address Plugin v1.5
 * http://www.asual.com/jquery/address/
 *
 * Copyright (c) 2009-2010 Rostislav Hristov
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Date: 2012-11-18 23:51:44 +0200 (Sun, 18 Nov 2012)
 */
(function(c){c.address=function(){var r=function(a){a=c.extend(c.Event(a),function(){for(var b={},f=c.address.parameterNames(),m=0,p=f.length;m<p;m++)b[f[m]]=c.address.parameter(f[m]);return{value:c.address.value(),path:c.address.path(),pathNames:c.address.pathNames(),parameterNames:f,parameters:b,queryString:c.address.queryString()}}.call(c.address));c(c.address).trigger(a);return a},s=function(a){return Array.prototype.slice.call(a)},h=function(){c().bind.apply(c(c.address),Array.prototype.slice.call(arguments));
return c.address},ea=function(){c().unbind.apply(c(c.address),Array.prototype.slice.call(arguments));return c.address},E=function(){return z.pushState&&d.state!==g},U=function(){return("/"+i.pathname.replace(new RegExp(d.state),"")+i.search+(L()?"#"+L():"")).replace(T,"/")},L=function(){var a=i.href.indexOf("#");return a!=-1?t(i.href.substr(a+1),k):""},u=function(){return E()?U():L()},V=function(){return"javascript"},O=function(a){a=a.toString();return(d.strict&&a.substr(0,1)!="/"?"/":"")+a},t=function(a,
b){if(d.crawlable&&b)return(a!==""?"!":"")+a;return a.replace(/^\!/,"")},v=function(a,b){return parseInt(a.css(b),10)},H=function(){if(!x){var a=u();if(decodeURI(e)!=decodeURI(a))if(w&&A<7)i.reload();else{w&&!F&&d.history&&q(M,50);_old=e;e=a;G(k)}}},G=function(a){var b=r(W);a=r(a?X:Y);q(fa,10);if(b.isDefaultPrevented()||a.isDefaultPrevented())ga()},ga=function(){e=_old;if(E())z.popState({},"",d.state.replace(/\/$/,"")+(e===""?"/":e));else{x=n;if(B)if(d.history)i.hash="#"+t(e,n);else i.replace("#"+
t(e,n));else if(e!=u())if(d.history)i.hash="#"+t(e,n);else i.replace("#"+t(e,n));w&&!F&&d.history&&q(M,50);if(B)q(function(){x=k},1);else x=k}},fa=function(){if(d.tracker!=="null"&&d.tracker!==I){var a=c.isFunction(d.tracker)?d.tracker:j[d.tracker],b=(i.pathname+i.search+(c.address&&!E()?c.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(c.isFunction(a))a(b);else if(c.isFunction(j.urchinTracker))j.urchinTracker(b);else if(j.pageTracker!==g&&c.isFunction(j.pageTracker._trackPageview))j.pageTracker._trackPageview(b);
else j._gaq!==g&&c.isFunction(j._gaq.push)&&j._gaq.push(["_trackPageview",decodeURI(b)])}},M=function(){var a=V()+":"+k+";document.open();document.writeln('<html><head><title>"+o.title.replace(/\'/g,"\\'")+"</title><script>var "+C+' = "'+encodeURIComponent(u()).replace(/\'/g,"\\'")+(o.domain!=i.hostname?'";document.domain="'+o.domain:"")+"\";<\/script></head></html>');document.close();";if(A<7)l.src=a;else l.contentWindow.location.replace(a)},$=function(){if(J&&Z!=-1){var a,b,f=J.substr(Z+1).split("&");
for(a=0;a<f.length;a++){b=f[a].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(b[0]))d[b[0]]=isNaN(b[1])?/^(true|yes)$/i.test(b[1]):parseInt(b[1],10)!==0;if(/^(state|tracker)$/.test(b[0]))d[b[0]]=b[1]}J=I}_old=e;e=u()},ba=function(){if(!aa){aa=n;$();var a=function(){ha.call(this);ia.call(this)},b=c("body").ajaxComplete(a);a();if(d.wrap){c("body > *").wrapAll('<div style="padding:'+(v(b,"marginTop")+v(b,"paddingTop"))+"px "+(v(b,"marginRight")+v(b,"paddingRight"))+"px "+(v(b,"marginBottom")+
v(b,"paddingBottom"))+"px "+(v(b,"marginLeft")+v(b,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+C+'" style="height:100%;overflow:auto;position:relative;'+(B&&!window.statusbar.visible?"resize:both;":"")+'" />');c("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});B&&c('<style type="text/css" />').appendTo("head").text("#"+C+"::-webkit-resizer { background-color: #fff; }")}if(w&&!F){a=o.getElementsByTagName("frameset")[0];l=o.createElement((a?"":"i")+"frame");l.src=V()+
":"+k;if(a){a.insertAdjacentElement("beforeEnd",l);a[a.cols?"cols":"rows"]+=",0";l.noResize=n;l.frameBorder=l.frameSpacing=0}else{l.style.display="none";l.style.width=l.style.height=0;l.tabIndex=-1;o.body.insertAdjacentElement("afterBegin",l)}q(function(){c(l).bind("load",function(){var f=l.contentWindow;_old=e;e=f[C]!==g?f[C]:"";if(e!=u()){G(k);i.hash=t(e,n)}});l.contentWindow[C]===g&&M()},50)}q(function(){r("init");G(k)},1);if(!E())if(w&&A>7||!w&&F)if(j.addEventListener)j.addEventListener(K,H,k);
else j.attachEvent&&j.attachEvent("on"+K,H);else ja(H,50);"state"in window.history&&c(window).trigger("popstate")}},ha=function(){var a,b=c("a"),f=b.size(),m=-1,p=function(){if(++m!=f){a=c(b.get(m));a.is('[rel*="address:"]')&&a.address('[rel*="address:"]');q(p,1)}};q(p,1)},ia=function(){if(d.crawlable){var a=i.pathname.replace(/\/$/,"");c("body").html().indexOf("_escaped_fragment_")!=-1&&c('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var b=c(this).attr("href").replace(/^http:/,
"").replace(new RegExp(a+"/?$"),"");if(b===""||b.indexOf("_escaped_fragment_")!=-1)c(this).attr("href","#"+encodeURI(decodeURIComponent(b.replace(/\/(.*)\?_escaped_fragment_=(.*)$/,"!$2"))))})}},g,I=null,C="jQueryAddress",K="hashchange",W="change",X="internalChange",Y="externalChange",n=true,k=false,d={autoUpdate:n,crawlable:k,history:n,strict:n,wrap:k},D=c.browser,A=parseFloat(D.version),w=!c.support.opacity,B=D.webkit||D.safari,j=function(){try{return top.document!==g&&top.document.title!==g?top:
window}catch(a){return window}}(),o=j.document,z=j.history,i=j.location,ja=setInterval,q=setTimeout,T=/\/{2,9}/g;D=navigator.userAgent;var F="on"+K in j,l,J=c("script:last").attr("src"),Z=J?J.indexOf("?"):-1,P=o.title,x=k,aa=k,ca=n,N=k,e=u();_old=e;if(w){A=parseFloat(D.substr(D.indexOf("MSIE")+4));if(o.documentMode&&o.documentMode!=A)A=o.documentMode!=8?7:8;var da=o.onpropertychange;o.onpropertychange=function(){da&&da.call(o);if(o.title!=P&&o.title.indexOf("#"+u())!=-1)o.title=P}}if(z.navigationMode)z.navigationMode=
"compatible";if(document.readyState=="complete")var ka=setInterval(function(){if(c.address){ba();clearInterval(ka)}},50);else{$();c(ba)}c(window).bind("popstate",function(){if(decodeURI(e)!=decodeURI(u())){_old=e;e=u();G(k)}}).bind("unload",function(){if(j.removeEventListener)j.removeEventListener(K,H,k);else j.detachEvent&&j.detachEvent("on"+K,H)});return{bind:function(){return h.apply(this,s(arguments))},unbind:function(){return ea.apply(this,s(arguments))},init:function(){return h.apply(this,["init"].concat(s(arguments)))},
change:function(){return h.apply(this,[W].concat(s(arguments)))},internalChange:function(){return h.apply(this,[X].concat(s(arguments)))},externalChange:function(){return h.apply(this,[Y].concat(s(arguments)))},baseURL:function(){var a=i.href;if(a.indexOf("#")!=-1)a=a.substr(0,a.indexOf("#"));if(/\/$/.test(a))a=a.substr(0,a.length-1);return a},autoUpdate:function(a){if(a!==g){d.autoUpdate=a;return this}return d.autoUpdate},crawlable:function(a){if(a!==g){d.crawlable=a;return this}return d.crawlable},
history:function(a){if(a!==g){d.history=a;return this}return d.history},state:function(a){if(a!==g){d.state=a;var b=U();if(d.state!==g)if(z.pushState)b.substr(0,3)=="/#/"&&i.replace(d.state.replace(/^\/$/,"")+b.substr(2));else b!="/"&&b.replace(/^\/#/,"")!=L()&&q(function(){i.replace(d.state.replace(/^\/$/,"")+"/#"+b)},1);return this}return d.state},strict:function(a){if(a!==g){d.strict=a;return this}return d.strict},tracker:function(a){if(a!==g){d.tracker=a;return this}return d.tracker},wrap:function(a){if(a!==
g){d.wrap=a;return this}return d.wrap},update:function(){N=n;this.value(e);N=k;return this},title:function(a){if(a!==g){q(function(){P=o.title=a;if(ca&&l&&l.contentWindow&&l.contentWindow.document){l.contentWindow.document.title=a;ca=k}},50);return this}return o.title},value:function(a){if(a!==g){a=O(a);if(a=="/")a="";if(e==a&&!N)return;_old=e;e=a;if(d.autoUpdate||N){G(n);if(E())z[d.history?"pushState":"replaceState"]({},"",d.state.replace(/\/$/,"")+(e===""?"/":e));else{x=n;if(B)if(d.history)i.hash=
"#"+t(e,n);else i.replace("#"+t(e,n));else if(e!=u())if(d.history)i.hash="#"+t(e,n);else i.replace("#"+t(e,n));w&&!F&&d.history&&q(M,50);if(B)q(function(){x=k},1);else x=k}}return this}return O(e)},path:function(a){if(a!==g){var b=this.queryString(),f=this.hash();this.value(a+(b?"?"+b:"")+(f?"#"+f:""));return this}return O(e).split("#")[0].split("?")[0]},pathNames:function(){var a=this.path(),b=a.replace(T,"/").split("/");if(a.substr(0,1)=="/"||a.length===0)b.splice(0,1);a.substr(a.length-1,1)=="/"&&
b.splice(b.length-1,1);return b},queryString:function(a){if(a!==g){var b=this.hash();this.value(this.path()+(a?"?"+a:"")+(b?"#"+b:""));return this}a=e.split("?");return a.slice(1,a.length).join("?").split("#")[0]},parameter:function(a,b,f){var m,p;if(b!==g){var Q=this.parameterNames();p=[];b=b===g||b===I?"":b.toString();for(m=0;m<Q.length;m++){var R=Q[m],y=this.parameter(R);if(typeof y=="string")y=[y];if(R==a)y=b===I||b===""?[]:f?y.concat([b]):[b];for(var S=0;S<y.length;S++)p.push(R+"="+y[S])}c.inArray(a,
Q)==-1&&b!==I&&b!==""&&p.push(a+"="+b);this.queryString(p.join("&"));return this}if(b=this.queryString()){f=[];p=b.split("&");for(m=0;m<p.length;m++){b=p[m].split("=");b[0]==a&&f.push(b.slice(1).join("="))}if(f.length!==0)return f.length!=1?f:f[0]}},parameterNames:function(){var a=this.queryString(),b=[];if(a&&a.indexOf("=")!=-1){a=a.split("&");for(var f=0;f<a.length;f++){var m=a[f].split("=")[0];c.inArray(m,b)==-1&&b.push(m)}}return b},hash:function(a){if(a!==g){this.value(e.split("#")[0]+(a?"#"+
a:""));return this}a=e.split("#");return a.slice(1,a.length).join("#")}}}();c.fn.address=function(r){var s;if(typeof r=="string"){s=r;r=undefined}c(this).attr("address")||c(s?s:this).live("click",function(h){if(h.shiftKey||h.ctrlKey||h.metaKey||h.which==2)return true;if(c(this).is("a")){h.preventDefault();h=r?r.call(this):/address:/.test(c(this).attr("rel"))?c(this).attr("rel").split("address:")[1].split(" ")[0]:c.address.state()!==undefined&&!/^\/?$/.test(c.address.state())?c(this).attr("href").replace(new RegExp("^(.*"+
c.address.state()+"|\\.)"),""):c(this).attr("href").replace(/^(#\!?|\.)/,"");c.address.value(h)}}).live("submit",function(h){if(c(this).is("form")){h.preventDefault();h=c(this).attr("action");h=r?r.call(this):(h.indexOf("?")!=-1?h.replace(/&$/,""):h+"?")+c(this).serialize();c.address.value(h)}}).attr("address",true);return this}})(jQuery);


// -------------------------------------------------------
// MERGED: /plugins/timeline/wellcomeTimeline.min.js


function cal_to_jd(b, a, c, d, e, g, h) { var j; if (0 == a) return alert("There is no year 0 in the Julian system!"), "invalid"; if (1582 == a && 10 == c && 4 < d && 15 > d) return alert("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"), "invalid"; "BCE" == b && (a = -a + 1); 2 < c ? (j = a, b = c + 1) : (j = a - 1, b = c + 13); b = Math.floor(Math.floor(365.25 * j) + Math.floor(30.6001 * b) + d + 1720995); 588829 <= d + 31 * (c + 12 * a) && (a = Math.floor(0.01 * j), b += 2 - a + Math.floor(0.25 * a)); e = e / 24 - 0.5; 0 > e && (e += 1, --b); g = 1E5 * (b + (e + (g + h / 60) / 60 / 24)); h = Math.floor(g); 0.5 < g - h && ++h; return h / 1E5 } function julianToGregorian(b) { var a, c, d, e; c = Math.floor(b); 2299161 <= c ? (a = Math.floor((c - 1867216 - 0.25) / 36524.25), a = c + 1 + a - Math.floor(0.25 * a)) : a = c; b = b - c + 0.5; 1 <= b && (b -= 1, ++a); a += 1524; c = Math.floor(6680 + (a - 2439870 - 122.1) / 365.25); d = Math.floor(365.25 * c); e = Math.floor((a - d) / 30.6001); a = Math.floor(a - d - Math.floor(30.6001 * e)); e = Math.floor(e - 1); 12 < e && (e -= 12); c = Math.floor(c - 4715); 2 < e && --c; 0 >= c && --c; d = Math.floor(24 * b); f = 60 * (60 * (24 * b - d) - Math.floor(60 * (24 * b - d))); f -= Math.floor(f); b = {}; b.month = e; b.day = a; 0 > c ? (c = -c, b.era = "BC") : b.era = "AD"; b.year = c; return b } function JDcalc(b) { for (var a, c = 0; c < b.era.length; ++c) if (b.era[c].checked) { a = b.era[c].value; break } for (var d, c = 0; c < b.calctype.length; ++c) if (b.calctype[c].checked) { d = b.calctype[c].value; break } if ("JD" == d) { for (var e, c = 0; c < b.month.length; ++c) if (b.month[c].selected) { e = c + 1; break } for (var g, c = 1; c <= b.day.length; ++c) if (b.day[c - 1].selected) { g = c; break } d = parseFloat(b.year.value); var c = parseFloat(b.hour.value), h = parseFloat(b.minute.value), j = parseFloat(b.second.value); 0 > d && (d = -d, a = "BCE", b.year.value = d, b.era[1].checked = !0); b.JDedit.value = cal_to_jd(a, d, e, g, c, h, j) } else jd_to_cal(b.JDedit.value, b); a = parseFloat(b.JDedit.value) + 0.5; b.wkday.value = "Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ")[Math.floor(7 * (a / 7 - Math.floor(a / 7)) + 3.17E-10)] } var month = "January February March April May June July August September October November December".split(" "), numdays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; function ModifiedDate() { updated = new Date(document.lastModified); Month = month[updated.getMonth()]; Day = updated.getDate(); Year = updated.getYear(); Hour = updated.getHours(); Min = updated.getMinutes(); 2E3 > Year && (Year += 1900); 2E3 > Year && (Year += 100); 10 > Hour && (Hour = "0" + Hour); 10 > Min && (Min = "0" + Min); document.write("Last modified " + Month + " " + Day + ", " + Year + " at " + Hour + ":" + Min) } function set_form_fields(b) { var a = new Date, c = a.getYear(); 2E3 > c && (c += 1900); 2E3 > c && (c += 100); var d = a.getMonth(), e = a.getDate(), g = a.getHours(), h = a.getMinutes(), j = a.getSeconds(), a = a.getTimezoneOffset() / 60, g = g + a; 24 <= g && (g -= 24, ++e, e > numdays[d - 1] && (e = 1, ++d, 11 < d && (d -= 12, ++c))); b.year.value = c; for (k = 0; k < b.month.length; ++k) if (k == d) { b.month[k].selected = !0; break } b.day.value = e; for (k = 1; k <= b.day.length; ++k) if (k == e) { b.day[k - 1].selected = !0; break } b.hour.value = g; b.minute.value = h; b.second.value = j; doJD(b) } function dodate(b) { for (k = 0; k < b.calctype.length; ++k) if ("date" == b.calctype[k].value) { b.calctype[k].checked = !0; break } } function doJD(b) { for (k = 0; k < b.calctype.length; ++k) if ("JD" == b.calctype[k].value) { b.calctype[k].checked = !0; break } } (function (b) { b.fn.repeatButton = function (a, c, d) { return this.each(function () { function e() { g = setInterval(d, c) } var g, h; b(this).mousedown(function () { d(); h = setTimeout(e, a) }).mouseup(function () { clearInterval(g); clearTimeout(h) }).mouseout(function () { clearInterval(g); clearTimeout(h) }) }) }; b.idleTimer = function (a, c, d) { d = b.extend({ startImmediately: !0, idle: !1, enabled: !0, timeout: 3E4, events: "mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove" }, d); c = c || document; var e = function (a) { "number" === typeof a && (a = void 0); a = b.data(a || c, "idleTimerObj"); a.idle = !a.idle; var g = +new Date - a.olddate; a.olddate = +new Date; a.idle && g < d.timeout ? (a.idle = !1, clearTimeout(b.idleTimer.tId), d.enabled && (b.idleTimer.tId = setTimeout(e, d.timeout))) : (a = jQuery.Event(b.data(c, "idleTimer", a.idle ? "idle" : "active") + ".idleTimer"), b(c).trigger(a)) }, g = b.data(c, "idleTimerObj") || {}; g.olddate = g.olddate || +new Date; if ("number" === typeof a) d.timeout = a; else { if ("destroy" === a) return a = c, g = b.data(a, "idleTimerObj") || {}, g.enabled = !1, clearTimeout(g.tId), b(a).off(".idleTimer"), this; if ("getElapsedTime" === a) return +new Date - g.olddate } b(c).on(b.trim((d.events + " ").split(" ").join(".idleTimer ")), function () { var a = b.data(this, "idleTimerObj"); clearTimeout(a.tId); a.enabled && (a.idle && e(this), a.tId = setTimeout(e, a.timeout)) }); g.idle = d.idle; g.enabled = d.enabled; g.timeout = d.timeout; d.startImmediately && (g.tId = setTimeout(e, g.timeout)); b.data(c, "idleTimer", "active"); b.data(c, "idleTimerObj", g) }; b.fn.idleTimer = function (a, c) { c || (c = {}); this[0] && b.idleTimer(a, this[0], c); return this }; b.fn.ellipsisFill = function (a) { return this.each(function () { var c = b(this); c.empty(); c.spanElem = b('<span title="' + a + '"></span>'); c.append(c.spanElem); c.css("overflow", "hidden"); c.spanElem.css("white-space", "nowrap"); c.spanElem.html(a); if (c.spanElem.width() > c.width()) for (var d; c.spanElem.width() > c.width() ;) { var e = c.spanElem.html(), e = e.substring(0, e.lastIndexOf(" ")) + "&hellip;"; if (e == d) break; c.spanElem.html(e); d = e } }) }; b.fn.ellipsisFixed = function (a, c) { return this.each(function () { var d = b(this), e = d.text(); d.empty(); var g = b("<span></span>"), h = b('<a href="#" title="more" class="ellipsis"></a>'); c ? h.html(c) : h.html("&hellip;"); h.click(function (a) { a.preventDefault(); a = b(this); g.html(e); a.remove() }); if (e.length > a) { var j = e.substr(0, a), j = j.substr(0, Math.min(j.length, j.lastIndexOf(" "))); g.html(j + "&nbsp;"); g.append(h) } else g.html(e); d.append(g) }) }; b.fn.toggleExpandText = function (a) { return this.each(function () { var c = b(this), d = c.text(); if (!(a > d.length)) { var e = !1, g = d.substr(0, a), g = g.substr(0, Math.min(g.length, g.lastIndexOf(" "))); c.toggle = function () { c.empty(); var a = b('<a href="#" class="toggle"></a>'); e ? (c.html(d + "&nbsp;"), a.text("less")) : (c.html(g + "&nbsp;"), a.text("more")); a.one("click", function (a) { a.preventDefault(); c.toggle() }); e = !e; c.append(a) }; c.toggle() } }) }; b.fn.ellipsis = function (a) { return this.each(function () { var c = b(this), d = c.text(); d.length > a && (d = d.substr(0, a), d = d.substr(0, Math.min(d.length, d.lastIndexOf(" "))), c.empty().html(d + "&hellip;")) }) } })(jQuery); window.log = function () { log.history = log.history || []; log.history.push(arguments); this.console && console.log(Array.prototype.slice.call(arguments)) }; String.format = function () { for (var b = arguments[0], a = 0; a < arguments.length - 1; a++) b = b.replace(RegExp("\\{" + a + "\\}", "gm"), arguments[a + 1]); return b }; String.prototype.startsWith = function (b) { return 0 == this.indexOf(b) }; String.prototype.trim = function () { return this.replace(/^\s\s*/, "").replace(/\s\s*$/, "") }; String.prototype.ltrim = function () { return this.replace(/^\s+/, "") }; String.prototype.rtrim = function () { return this.replace(/\s+$/, "") }; String.prototype.fulltrim = function () { return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g, "").replace(/\s+/g, " ") }; String.prototype.toFileName = function () { return this.replace(/[^a-z0-9]/gi, "_").toLowerCase() }; function ellipsis(b, a) { if (b.length <= a) return b; var c = b.substr(0, a), c = c.substr(0, Math.min(c.length, c.lastIndexOf(" "))); return c + "&hellip;" } function numericalInput(b) { if (!(46 == b.keyCode || 8 == b.keyCode || 9 == b.keyCode || 27 == b.keyCode || 65 == b.keyCode && !0 === b.ctrlKey || 35 <= b.keyCode && 39 >= b.keyCode)) if (b.shiftKey || (48 > b.keyCode || 57 < b.keyCode) && (96 > b.keyCode || 105 < b.keyCode)) return b.preventDefault(), !1; return !0 } function clamp(b, a, c) { return Math.min(Math.max(b, a), c) } function roundNumber(b, a) { return Math.round(b * Math.pow(10, a)) / Math.pow(10, a) } function normalise(b, a, c) { return (b - a) / (c - a) } function fitRect(b, a, c, d) { var e = a / b, g = d / c, h, j; e < g && (c /= b, h = b * c, j = a * c); g < e && (c = d / a, h = b * c, j = a * c); return { width: Math.floor(h), height: Math.floor(j) } } Array.prototype.indexOf || (Array.prototype.indexOf = function (b, a) { for (var c = a || 0, d = this.length; c < d; c++) if (this[c] === b) return c; return -1 }); function getTimeStamp() { return (new Date).getTime() } function getParameterByName(b) { b = b.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"); b = RegExp("[\\?&]" + b + "=([^&#]*)").exec(window.location.search); return null == b ? "" : decodeURIComponent(b[1].replace(/\+/g, " ")) } function getUrlParts(b) { var a = document.createElement("a"); a.href = b; return { href: a.href, host: a.host, hostname: a.hostname, port: a.port, pathname: a.pathname, protocol: a.protocol, hash: a.hash, search: a.search } } function convertToRelativeUrl(b) { b = getUrlParts(b); b = b.pathname + b.search; b.startsWith("/") || (b = "/" + b); return b } "function" !== typeof Object.create && (Object.create = function (b) { var a = function () { }; a.prototype = b; return new a }); Object.size = function (b) { var a = 0, c; for (c in b) b.hasOwnProperty(c) && a++; return a }; function debounce(b, a) { a = a || 100; return function () { if (!b.debouncing) { var c = Array.prototype.slice.apply(arguments); b.lastReturnVal = b.apply(window, c); b.debouncing = !0 } clearTimeout(b.debounceTimeout); b.debounceTimeout = setTimeout(function () { b.debouncing = !1 }, a); return b.lastReturnVal } } function getMaxZIndex() { return Math.max.apply(null, $.map($("body > *"), function (b) { if ("absolute" == $(b).css("position")) return parseInt($(b).css("z-index")) || 1 })) } function BaseProvider() { this.options = { dataUriTemplate: "{0}{1}.js" }; this.load = function () { this.data = this.options.data } } WellcomeTimelineProvider.prototype = new BaseProvider; WellcomeTimelineProvider.prototype.constructor = WellcomeTimelineProvider; function WellcomeTimelineProvider(b) { $.extend(this.options, b, { provider: this, maxTicks: 100, maxYearIntervalWidth: 500, maxDecadeIntervalWidth: 2E3, maxCenturyIntervalWidth: 500, zoomAnimationDuration: 1E3, eventFadeDuration: 500, zoomFactor: 3, eventStackSize: 3, padding: 0 }); this.create = function (a) { $.extend(this.options, a); this.load(); this.options.element.timeline(this.options) }; this.getTimelineStartDate = function () { return this.getDate(this.data.EarliestJulianDay).add("years", -1 * this.options.padding) }; this.getTimelineEndDate = function () { return this.getDate(this.data.LastJulianDay).add("years", this.options.padding) }; this.setEventStartDate = function (a) { a.startDate = this.getDate(a.JulianDayStart) }; this.setEventEndDate = function (a) { a.endDate = 0 > a.JulianDayEnd ? this.getDate(a.JulianDayStart) : this.getDate(a.JulianDayEnd) }; this.getDate = function (a) { a = julianToGregorian(a); return moment(new Date(a.year, a.month - 1, a.day)) }; this.remove = function () { } } (function (b) { b.widget("wellcome.timeline_baseTimeline", { currentIndex: -1, isFullScreen: !1, _create: function () { var a = this; b.wellcome.timeline = a; a.provider = a.options.provider; a.RESIZE = "onResize"; a.TOGGLE_FULLSCREEN = "onToggleFullScreen"; a.ZOOM_IN = "onZoomIn"; a.ZOOM_OUT = "onZoomOut"; a.START_ZOOM = "onStartZoom"; a.FINISH_ZOOM = "onFinishZoom"; a.START_SCROLL = "onStartScroll"; a.SCROLL_STEP = "onScrollStep"; a.FINISH_SCROLL = "onFinishScroll"; a.START_NAVIGATING = "onStartNavigating"; a.FINISH_NAVIGATING = "onFinishNavigating"; a.START_INDEX_CHANGE = "onStartIndexChange"; a.FINISH_INDEX_CHANGE = "onFinishIndexChange"; a.SHOW_GENERIC_DIALOGUE = "onShowGenericDialogue"; a.HIDE_GENERIC_DIALOGUE = "onHideGenericDialogue"; a.SHOW_EMBED_DIALOGUE = "onShowEmbedDialogue"; a.HIDE_EMBED_DIALOGUE = "onHideEmbedDialogue"; a.SHOW_HELP_DIALOGUE = "onShowHelpDialogue"; a.HIDE_HELP_DIALOGUE = "onHideHelpDialogue"; a.SHOW_EVENT_DETAILS_DIALOGUE = "onShowEventDetailsDialogue"; a.HIDE_EVENT_DETAILS_DIALOGUE = "onHideEventDetailsDialogue"; a.RETURN = "onReturn"; a.ESCAPE = "onEscape"; a.REDIRECT = "onRedirect"; a.CLOSE_ACTIVE_DIALOGUE = "onCloseActiveDialogue"; a.REFRESHED = "onRefreshed"; b.wellcome.timeline.bind(b.wellcome.timeline.ESCAPE, function () { a.isFullScreen && a._toggleFullScreen() }); a.socket = new easyXDM.Socket({ onMessage: function (c) { c = b.parseJSON(c); a.handleParentFrameEvent(c) } }); b(window).resize(function () { a._resize() }); b(window).bind("unload", function () { }); a.options.isHomeDomain || a.element.addClass("embedded"); b(document).keyup(function (b) { 27 === b.keyCode && a._trigger(a.ESCAPE); 13 === b.keyCode && a._trigger(a.RETURN) }); b(document).mousemove(function (b) { a.mouseX = b.pageX; a.mouseY = b.pageY }); a.options.isHomeDomain || trackVariable(2, "Timeline Embedded", a.options.url, 2) }, changeIndex: function (a) { if (!(-1 > a) && !(a > this.provider.data.Events.length - 1)) { this.lastIndex = this.currentIndex; this._deselectCurrentEvent(); this.currentIndex = a; this._trigger(this.START_INDEX_CHANGE, a); this._trigger(this.SHOW_EVENT_DETAILS_DIALOGUE); var c = "0"; -1 != a && (c = b.wellcome.timeline.getEventByIndex(a).EventId); this.setAddress(c) } }, viewEvent: function (a) { for (var b = this, d = 0, e = b.provider.data.Events.length; d < e; d++) if (b.provider.data.Events[d].EventId == a) { setTimeout(function () { b.changeIndex(d) }, 100); break } }, getView: function (a) { return this.element.timeline_shell("getView", a) }, getAbsoluteUrl: function () { return b.address.baseURL() + "#" + b.address.path() }, getRelativeUrl: function () { var a = this.getAbsoluteUrl(), a = getUrlParts(a).pathname + "#" + b.address.path(); a.startsWith("/") || (a = "/" + a); return a }, updateAddress: function () { if (this.urlParamsEnabled()) { for (var a = Array.prototype.slice.call(arguments), c = b.address.pathNames(), d = Math.max(a.length, c.length), e = Array(d), g = 0; g < c.length; g++) e[g] = c[g]; for (g = 0; g < a.length; g++) e[g] = a[g]; a = "#"; for (g = 0; g < d; g++) a += e[g], g != d - 1 && (a += "/"); this.updateParentHash(a) } }, setAddress: function () { if (this.urlParamsEnabled()) { for (var a = Array.prototype.slice.call(arguments), b = "#", d = 0; d < a.length; d++) b += a[d], d != a.length - 1 && (b += "/"); this.updateParentHash(b) } }, updateParentHash: function (a) { var b = window.parent.document.URL; -1 != b.indexOf("#") && (b = b.substr(0, b.indexOf("#"))); window.parent.document.location.replace(b + a) }, bind: function (a, b) { this.element.bind(a, b) }, _trigger: function (a, b) { this.element.trigger(a, b) }, triggerSocket: function (a, b) { this.socket && this.socket.postMessage(JSON.stringify({ eventName: a, eventObject: b })) }, handleParentFrameEvent: function (a) { switch (a.eventName) { case this.TOGGLE_FULLSCREEN: this._trigger(this.TOGGLE_FULLSCREEN, a.eventObject) } }, _resize: function () { this.options.enforceMinWidth ? b(window).width() >= this.options.minWidth && this._trigger(this.RESIZE) : this._trigger(this.RESIZE) }, redirect: function (a) { this.triggerSocket(this.REDIRECT, a) }, isEmbedEnabled: function () { return "false" !== this.options.config.Settings.EmbedEnabled }, urlParamsEnabled: function () { return "false" !== this.options.isHomeDomain && "false" !== this.options.isOnlyInstance }, _toggleFullScreen: function () { this.isFullScreen = !this.isFullScreen; this.triggerSocket(this.TOGGLE_FULLSCREEN, this.isFullScreen) }, closeActiveDialogue: function () { this._trigger(this.CLOSE_ACTIVE_DIALOGUE) }, showDialogue: function (a, b) { this._trigger(this.SHOW_GENERIC_DIALOGUE, { message: a, acceptCallback: b }) }, embed: function () { this._trigger(this.SHOW_EMBED_DIALOGUE) }, help: function () { this._trigger(this.SHOW_HELP_DIALOGUE) } }) })(jQuery); (function (b) { b.widget("wellcome.wellcomeTimeline", { options: {}, _create: function () { var a = this; b.getJSON(a.options.configUri, function (c) { a.config = c; b.getJSON(a.options.dataUri, function (b) { a.data = b; a._viewPackage() }) }) }, _viewPackage: function () { this._reset(); this.options.provider.create({ element: this.element, baseUri: this.options.baseUri, timelineId: this.options.timelineId, dataUriTemplate: this.options.dataUriTemplate, dataUri: this.options.dataUri, eventId: this.options.eventId, data: this.data, config: this.config, embedScriptUri: this.options.embedScriptUri, isHomeDomain: this.options.isHomeDomain, isOnlyInstance: this.options.isOnlyInstance, url: this.options.url }) }, _reset: function () { this.element.empty(); this.options.provider.remove() }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline", b.wellcome.timeline_baseTimeline, { _create: function () { var a = this; b.wellcome.timeline_baseTimeline.prototype._create.call(a); a.element.timeline_shell({ onCloseActiveDialogue: function () { b.wellcome.timeline.closeActiveDialogue() } }); a.headerPanelView = a.getView("header"); a.headerPanelView.timeline_headerPanelView({ onZoomIn: function () { a._trigger(a.ZOOM_IN) }, onZoomOut: function () { a._trigger(a.ZOOM_OUT) } }); a.mainPanelView = a.getView("main"); a.mainPanelView.timeline_mainPanelView({ onSelectEvent: function (b, d) { "object" == typeof d && (d = 0); a.changeIndex(d) }, onSelectEventComplete: function (b, d) { "object" == typeof d && (d = 0); a._trigger(a.FINISH_INDEX_CHANGE, d) }, onStartZoom: function () { a._trigger(a.START_ZOOM) }, onFinishZoom: function () { a._trigger(a.FINISH_ZOOM) }, onStartScroll: function (b, d) { a._trigger(a.START_SCROLL, d) }, onScrollStep: function (b, d) { a._trigger(a.SCROLL_STEP, { direction: d.direction, pos: d.pos }) }, onFinishScroll: function (b, d) { a._trigger(a.FINISH_SCROLL, d) }, onStartNavigating: function () { a._trigger(a.START_NAVIGATING) }, onFinishNavigating: function () { a._trigger(a.FINISH_NAVIGATING) }, onRefreshed: function () { a._trigger(a.REFRESHED) } }); a.footerPanelView = a.getView("footer"); a.footerPanelView.timeline_footerPanelView({ onToggleFullScreen: function () { a._toggleFullScreen() }, onEmbed: function () { a.embed() } }); a.detailsView = a.getView("details"); a.detailsView.timeline_detailsView({ onClose: function () { a._deselectCurrentEvent(); a._trigger(a.HIDE_EVENT_DETAILS_DIALOGUE) }, onSelectPrev: function () { a.changeIndex(a.currentIndex - 1) }, onSelectNext: function () { a.changeIndex(a.currentIndex + 1) } }); a.genericDialogueView = a.getView("genericDialogue"); a.genericDialogueView.timeline_genericDialogueView({ onClose: function () { a._trigger(a.HIDE_GENERIC_DIALOGUE) }, onAccept: function () { a._trigger(a.HIDE_GENERIC_DIALOGUE) } }); a.embedView = a.getView("embed"); a.embedView.timeline_embedView({ onClose: function () { a._trigger(a.HIDE_EMBED_DIALOGUE) } }); a._resize(); a._getParams() }, _getParams: function () { if (this.urlParamsEnabled()) { b.address.history(!0); var a = b.address.pathNames(); a.length && (a = Number(a[0]), 0 != a && this.viewEvent(a)) } else this.options.eventId && this.viewEvent(this.options.eventId) }, _deselectCurrentEvent: function () { this.currentIndex = -1; this.element.find(".event").removeClass("selected"); this.element.find(".tickEvent").removeClass("selected") }, getCurrentEvent: function () { return -1 == this.currentIndex ? null : this.getEventByIndex(this.currentIndex) }, getEventByIndex: function (a) { return this.provider.data.Events[a] }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_shell", { options: {}, view: function (a, b) { this.name = a; this.element = b }, views: [], _create: function () { var a = this; b.wellcome.timeline.bind(b.wellcome.timeline.RESIZE, function () { a._resize() }); b.wellcome.timeline.bind(b.wellcome.timeline.SHOW_EVENT_DETAILS_DIALOGUE, function () { }); b.wellcome.timeline.bind(b.wellcome.timeline.HIDE_EVENT_DETAILS_DIALOGUE, function () { }); b.wellcome.timeline.bind(b.wellcome.timeline.SHOW_EMBED_DIALOGUE, function () { a.overlayMaskElem.show() }); b.wellcome.timeline.bind(b.wellcome.timeline.HIDE_EMBED_DIALOGUE, function () { a.overlayMaskElem.hide() }); a.containerElem = a.element; a.headerPanelElem = b('<div class="headerPanel"></div>'); a.containerElem.append(a.headerPanelElem); a.views.push(new a.view("header", a.headerPanelElem)); a.mainPanelElem = b('<div class="mainPanel"></div>'); a.containerElem.append(a.mainPanelElem); a.views.push(new a.view("main", a.mainPanelElem)); a.footerPanelElem = b('<div class="footerPanel"></div>'); a.containerElem.append(a.footerPanelElem); a.views.push(new a.view("footer", a.footerPanelElem)); a.detailsViewElem = b('<div class="overlay detailsView"></div>'); a.containerElem.append(a.detailsViewElem); a.views.push(new a.view("details", a.detailsViewElem)); a.overlayMaskElem = b('<div class="overlayMask"></div>'); a.containerElem.append(a.overlayMaskElem); a.helpViewElem = b('<div class="overlay helpView"></div>'); a.containerElem.append(a.helpViewElem); a.views.push(new a.view("help", a.helpViewElem)); a.genericDialogueViewElem = b('<div class="overlay genericDialogueView"></div>'); a.containerElem.append(a.genericDialogueViewElem); a.views.push(new a.view("genericDialogue", a.genericDialogueViewElem)); a.embedViewElem = b('<div class="overlay embedView"></div>'); a.containerElem.append(a.embedViewElem); a.views.push(new a.view("embed", a.embedViewElem)); a.overlayMaskElem.hide(); a.overlayMaskElem.click(function (b) { b.preventDefault(); a._trigger("onCloseActiveDialogue") }) }, _toggleFullScreen: function () { var a = b(window); this.containerElem.width(a.width()); this.containerElem.height(a.height()) }, _resize: function () { var a = b(window), c = a.width(), a = a.height(); this.containerElem.width(c); this.containerElem.height(a); var d = a - this.headerPanelElem.outerHeight(!0) - this.footerPanelElem.outerHeight(!0); this.mainPanelElem.height(d); d = this.headerPanelElem.height() + this.mainPanelElem.find("#scroll").height(); d = a - this.footerPanelElem.height() < d + this.detailsViewElem.height() ? a / 2 - this.detailsViewElem.height() / 2 : d; this.detailsViewElem.css({ top: d, left: c / 2 - this.detailsViewElem.width() / 2 }); this.overlayMaskElem.width(c); this.overlayMaskElem.height(a); this._centerView(a, c, this.genericDialogueViewElem); this.embedViewElem.css({ top: a - this.embedViewElem.outerHeight(!0) }) }, _centerView: function (a, b, d) { d.css({ top: a / 2 - d.height() / 2, left: b / 2 - d.width() / 2 }) }, getView: function (a) { for (var b = 0; b < this.views.length; b++) { var d = this.views[b]; if (d.name.toLowerCase() == a.toLowerCase()) return d.element } return null }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_headerPanelView", { isZoomInEnabled: !0, isZoomOutEnabled: !0, isNavigating: !1, _create: function () { var a = this; b.wellcome.timeline.bind(b.wellcome.timeline.RESIZE, function () { a._resize() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_ZOOM, function () { a._disableZoomIn(); a._disableZoomOut() }); b.wellcome.timeline.bind(b.wellcome.timeline.FINISH_ZOOM, function () { a._refresh() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_SCROLL, function () { a._disableZoomIn(); a._disableZoomOut() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_NAVIGATING, function () { a.isNavigating = !0 }); b.wellcome.timeline.bind(b.wellcome.timeline.FINISH_NAVIGATING, function () { a.isNavigating = !1 }); b.wellcome.timeline.bind(b.wellcome.timeline.REFRESHED, function () { a._refresh() }); a.leftColElem = b('<div class="leftCol"></div>'); a.element.append(a.leftColElem); a.titleElem = b('<div class="title"></div>'); a.leftColElem.append(a.titleElem); a.rightColElem = b('<div class="rightCol"></div>'); a.element.append(a.rightColElem); a.zoomOutButtonElem = b('<div class="zoomOut"></div>'); a.rightColElem.append(a.zoomOutButtonElem); a.zoomInButtonElem = b('<div class="zoomIn"></div>'); a.rightColElem.append(a.zoomInButtonElem); a.title = b.wellcome.timeline.options.provider.data.Title; a.title += ": <span>" + b.wellcome.timeline.provider.data.StartDateDisplay + " - " + b.wellcome.timeline.provider.data.EndDateDisplay + "</span>"; a.titleElem.ellipsisFill(a.title); a.zoomInButtonElem.prop("title", b.wellcome.timeline.options.config.HeaderPanelView.ZoomIn); a.zoomOutButtonElem.prop("title", b.wellcome.timeline.options.config.HeaderPanelView.ZoomOut); a.zoomInButtonElem.on("click", function (b) { b.preventDefault(); a.isZoomInEnabled && a._trigger("onZoomIn") }); a.zoomOutButtonElem.on("click", function (b) { b.preventDefault(); a.isZoomOutEnabled && a._trigger("onZoomOut") }) }, _disableZoomIn: function () { this.isZoomInEnabled = !1; this.zoomInButtonElem.fadeTo(0, 0.5) }, _enableZoomIn: function () { this.isZoomInEnabled = !0; this.zoomInButtonElem.fadeTo(0, 1) }, _disableZoomOut: function () { this.isZoomOutEnabled = !1; this.zoomOutButtonElem.fadeTo(0, 0.5) }, _enableZoomOut: function () { this.isZoomOutEnabled = !0; this.zoomOutButtonElem.fadeTo(0, 1) }, _resize: function () { var a = this.element.width() - this.rightColElem.width(); this.leftColElem.width(a); this.titleElem.ellipsisFill(this.title) }, _refresh: function () { this.isNavigating || (b.wellcome.timeline.isMinZoom ? this._disableZoomOut() : this._enableZoomOut(), b.wellcome.timeline.isMaxZoom ? this._disableZoomIn() : this._enableZoomIn()) }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_mainPanelView", { currentZoomLevel: 0, lastZoomLevel: null, hasZoomed: !1, isZooming: !1, isNavigating: !1, days: 0, years: 0, decades: 0, centuries: 0, yearTicks: { elem: null, ticks: [] }, decadeTicks: { elem: null, ticks: [] }, centuryTicks: { elem: null, ticks: [] }, _create: function () { var a = this; b.wellcome.timeline.bind(b.wellcome.timeline.RESIZE, function () { a._resize() }); b.wellcome.timeline.bind(b.wellcome.timeline.ZOOM_IN, function () { a._zoomIn() }); b.wellcome.timeline.bind(b.wellcome.timeline.ZOOM_OUT, function () { a._zoomOut() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_INDEX_CHANGE, function (b, d) { -1 != d && a._navigateToEvent(a.events[d]) }); a.scrollElem = b('<div id="scroll"></div>'); a.element.append(a.scrollElem); a.contentElem = b('<div class="content"></div>'); a.scrollElem.append(a.contentElem); a.backgroundEventsElem = b('<div class="backgroundEvents"></div>'); a.contentElem.append(a.backgroundEventsElem); a.eventsElem = b('<div class="events"></div>'); a.contentElem.append(a.eventsElem); a.timeElem = b('<div class="time"></div>'); a.contentElem.append(a.timeElem); a.yearTicksElem = b('<div class="ticks years"></div>'); a.timeElem.append(a.yearTicksElem); a.decadeTicksElem = b('<div class="ticks decades"></div>'); a.timeElem.append(a.decadeTicksElem); a.centuryTicksElem = b('<div class="ticks centuries"></div>'); a.timeElem.append(a.centuryTicksElem); a.backgroundEventTemplateElem = b('                <div class="event">                    <div class="title"></div>                    <div class="timeSpan"></div>                </div>'); a.eventTemplateElem = b('                <div class="event">                    <div class="wrap">                        <div class="leftCol"><img /></div>                        <div class="rightCol">                            <div class="date"></div>                            <div class="title"></div>                        </div>                    </div>                    <div class="arrow"></div>                    <div class="line"></div>                </div>'); a.tickTemplateElem = b('                <div class="tick">                    <div class="date"></div>                    <div class="events"></div>                </div>'); a.tickEventTemplateElem = b('<div class="tickEvent"></div>') }, _init: function () { this.scroll = new iScroll("scroll", { hScrollbar: !1, vScrollbar: !1, hideScrollbar: !0 }); b(this.scroll.scroller).on("selectstart", function () { return !1 }); this.yearTicksElem.hide(); this.decadeTicksElem.hide(); this.centuryTicksElem.hide(); this.backgroundEvents = b.wellcome.timeline.provider.data.BackgroundEvents; this.events = b.wellcome.timeline.provider.data.Events; var a = b.wellcome.timeline.provider.getTimelineStartDate(), c = b.wellcome.timeline.provider.getTimelineEndDate(); c.year() == a.year() ? (a = moment(new Date(a.year(), 1, 1)), c = a.add("years", 1).subtract("days", 1)) : 10 > c.year() - a.year() ? (a = moment(new Date(a.year(), 1, 1)), c = moment(new Date(c.year(), 1, 1)).add("years", 1).subtract("days", 1)) : 100 > c.year() - a.year() ? (a = this._getDecade(a), a = moment(new Date(a, 1, 1)), c = this._getDecade(c), c = moment(new Date(c, 1, 1)).add("years", 10).subtract("days", 1)) : (a = this._getCentury(a), a = moment(new Date(a, 1, 1)), c = this._getCentury(c), c = moment(new Date(c, 1, 1)).add("years", 100).subtract("days", 1)); this.startDate = a; this.endDate = c; this.days = this.endDate.diff(this.startDate, "days"); this.years = this.endDate.diff(this.startDate, "years"); this.decades = Math.floor(this.years / 10); this.centuries = Math.floor(this.years / 100); this._createBackgroundEvents(); this._createEvents(); this._createTicks() }, _createBackgroundEvents: function () { var a, c, d; a = 0; for (c = this.backgroundEvents.length; a < c; a++) { d = this.backgroundEvents[a]; d.index = a; var e = this.backgroundEventTemplateElem.clone(); d.elem = e; e.data("index", d.index); d.titleElem = e.find(".title"); d.titleElem.text(d.Title); e.prop("title", d.Title); d.timeSpanElem = e.find(".timeSpan"); b.wellcome.timeline.provider.setEventStartDate(d); b.wellcome.timeline.provider.setEventEndDate(d); this.backgroundEventsElem.append(e); e = d.startDate.diff(this.startDate, "days"); d.startPosition = normalise(e, 0, this.days); e = d.endDate.diff(this.startDate, "days"); d.endPosition = normalise(e, 0, this.days) } }, _createEvents: function () { var a = this, c, d, e; c = moment(); a.endDate.year() >= c.year() && a.events.push({ isPresent: !0, startDate: c, endDate: c, Title: b.wellcome.timeline.options.config.MainPanelView.PresentDay, Priority: 1 }); c = 0; for (d = a.events.length; c < d; c++) { e = a.events[c]; e.index = c; var g = a.eventTemplateElem.clone(); e.elem = g; g.data("index", e.index); var h = g.find("img"), j = g.find(".date"), l = g.find(".title"); e.ThumbnailPath ? (g.removeClass("min"), h.prop("src", e.ThumbnailPath)) : g.addClass("min"); l.text(e.Title); l.ellipsis(45); e.isPresent ? (j.text(e.startDate.year()), g.addClass("present")) : (j.text(e.StartDisplayYear), g.prop("title", e.StartDisplayYear + ": " + e.Title), g.on("click", function () { if (!a.isNavigating && !a.isZooming) { var c = parseInt(b(this).data("index")); a._selectEvent(c) } }), g.on("mouseenter", function () { if (!a.isNavigating && !a.isZooming) { var c = b(this).data("index"); a._highlightEvent(c) } }), g.on("mouseleave", function () { if (!a.isNavigating && !a.isZooming) { var c = b(this).data("index"); a._unhighlightEvent(c) } }), b.wellcome.timeline.provider.setEventStartDate(e), b.wellcome.timeline.provider.setEventEndDate(e)); a.eventsElem.append(g); g = e.startDate.diff(a.startDate, "days"); e.position = normalise(g, 0, a.days); e.width = e.elem.outerWidth(); e.elem.hide() } a.eventStack = []; c = 0; for (d = b.wellcome.timeline.provider.options.eventStackSize; c < d; c++) a.eventStack.push([]); c = g = 0; for (d = a.events.length; c < d; c++) e = a.events[c], e.stackLevel = g, a.eventStack[g].push(e), g == b.wellcome.timeline.provider.options.eventStackSize - 1 ? g = 0 : g++ }, _createTicks: function () { var a, b, d; a = this.startDate.year(); for (b = this.endDate.year() ; a < b; a++) d = { startYear: a, endYear: a }, this._associateEventsWithTick(d), this.yearTicks.ticks.push(d); this.yearTicks.elem = this.yearTicksElem; this._createTickElems(this.yearTicks); if (this.decades) { a = this._getDecade(this.startDate); for (b = this._getDecade(this.endDate) ; a < b; a += 10) d = { startYear: a, endYear: a + 9 }, this._associateEventsWithTick(d), this.decadeTicks.ticks.push(d); this.decadeTicks.elem = this.decadeTicksElem; this._createTickElems(this.decadeTicks) } if (this.centuries) { a = this._getCentury(this.startDate); for (b = this._getCentury(this.endDate) ; a < b; a += 100) d = { startYear: a, endYear: a + 99 }, this._associateEventsWithTick(d), this.centuryTicks.ticks.push(d); this.centuryTicks.elem = this.centuryTicksElem; this._createTickElems(this.centuryTicks) } }, _createTickElems: function (a) { for (var c = this, d = 0, e = a.ticks.length; d < e; d++) { var g = a.ticks[d], h = c.tickTemplateElem.clone(); g.elem = h; g.elem.find(".date").append(g.startYear); for (var h = g.elem.find(".events"), j = 0, l = g.events.length; j < l; j++) { var m = g.events[j], n = c.tickEventTemplateElem.clone(); n.data("index", m.index); n.attr("title", m.StartDisplayYear + ": " + m.Title); n.on("click", function () { if (!c.isNavigating && !c.isZooming) { var a = b(this).data("index"); c._selectEvent(a) } }); n.on("mouseenter", function () { if (!c.isNavigating && !c.isZooming) { var a = b(this).data("index"); c._highlightEvent(a) } }); n.on("mouseleave", function () { if (!c.isNavigating && !c.isZooming) { var a = b(this).data("index"); c._unhighlightEvent(a) } }); h.append(n) } a.elem.append(g.elem) } }, _associateEventsWithTick: function (a) { a.events = []; for (var b = 0, d = this.events.length; b < d; b++) { var e = this.events[b]; if (e.isPresent) break; var g = e.startDate.year(); g >= a.startYear && g <= a.endYear && a.events.push(e) } }, _setEventsZIndex: function (a) { for (var b = 0, d = this.events.length; b < d; b++) { var e = this.events[b]; null != a ? e.stackLevel == a && this._setEventZIndex(e) : this._setEventZIndex(e) } }, _setEventZIndex: function (a) { var b = parseInt(this.eventsElem.css("zIndex")) + 2 * a.stackLevel + 1; a.elem.css("zIndex", b) }, _setCurrentEventToTop: function () { this._getCurrentEvent() && this._setEventToTop(this._getCurrentEvent()) }, _setEventToTop: function (a) { this._setEventsZIndex(a.stackLevel); var b = parseInt(a.elem.css("zIndex")) + 1; a.elem.css("zIndex", b) }, _updateNavigationAvailability: function () { b.wellcome.timeline.isMinZoom = this._isMinZoom(); b.wellcome.timeline.isMaxZoom = this._isMaxZoom() }, _updateVisibleEvents: function () { var a, b, d; a = 0; for (b = this.events.length; a < b; a++) d = this.events[a], d.isVisible = !0; if (!this._isMaxZoom()) { a = 0; for (b = this.eventStack.length; a < b; a++) this._updateStackLevelVisibleEvents(this.eventStack[a]) } }, _updateStackLevelVisibleEvents: function (a) { for (var b = 0, d = a.length; b < d; b++) { var e = a[b]; if (e.isVisible) for (var g = e.leftPos + e.width + 10, h = b + 1, j = a.length; h < j; h++) { var l = a[h]; if (l.isVisible) if (l.leftPos < g) if (l.Priority > e.Priority) l.isVisible = !1; else if (l.Priority < e.Priority) { e.isVisible = !1; break } else l.isVisible = !1; else break } } }, _showVisibleEvents: function (a) { for (var c = b(), d = b(), e = 0, g = this.events.length; e < g; e++) { var h = this.events[e]; h.isVisible ? c = c.add(h.elem) : d = d.add(h.elem) } b.when(c.fadeIn(b.wellcome.timeline.options.eventFadeDuration), d.fadeOut(b.wellcome.timeline.options.eventFadeDuration)).then(function () { a() }) }, _getCurrentEvent: function () { return b.wellcome.timeline.getCurrentEvent() }, _updateVisibleTicks: function () { for (var a = 0, c = this.currentTicks.ticks.length; a < c; a++) for (var d = this.currentTicks.ticks[a].elem.find(".events .tickEvent"), e = 0, g = d.length; e < g; e++) { var h = b(d[e]); b.wellcome.timeline.getEventByIndex(h.data("index")).isVisible ? (h.addClass("available"), h.removeClass("hidden")) : (h.removeClass("available"), h.addClass("hidden")) } }, _selectEvent: function (a) { b.wellcome.timeline.currentIndex != a && this._trigger("onSelectEvent", null, a) }, _selectTickEvent: function (a) { this._getTickEventElem(a).addClass("selected"); this._isMaxZoom() && this._setEventToTop(a) }, _getTickEventElem: function (a) { for (var c = 0, d = this.currentTicks.ticks.length; c < d; c++) for (var e = this.currentTicks.ticks[c].elem.find(".tickEvent"), g = 0, h = e.length; g < h; g++) { var j = b(e[g]), l = b.wellcome.timeline.getEventByIndex(j.data("index")); if (a === l) return j } return null }, _navigateToEvent: function (a) { var c = this; c.isNavigating = !0; c._trigger("onStartNavigating"); var d = Math.floor(c._getContentWidth() * c._getCurrentScrollPosition()), e = c._getEventScrollPosition(a.index), g; g = b.wellcome.timeline.lastIndex < b.wellcome.timeline.currentIndex ? -1 : 1; d == e && (e = d + g); var h = Math.abs(d - e), h = clamp(h, 750, 1250); c._trigger("onStartScroll", null, g.toString()); b({ val: d }).animate({ val: e }, { duration: 0.6 * h, easing: "easeInOutCubic", step: function () { c._scrollToPosition(Math.floor(this.val)); var a = normalise(this.val, d, e); c._trigger("onScrollStep", null, { direction: g.toString(), pos: a.toString() }) }, complete: function () { c._trigger("onFinishScroll", null, g.toString()); c._zoomUntilVisible(a, function () { c._refresh(function () { c.isNavigating = !1; c._trigger("onFinishNavigating"); c._trigger("onFinishZoom"); c._trigger("onSelectEventComplete", null, a.index) }) }) } }) }, _zoomIn: function () { var a = this; a._zoom(1, function () { a._refresh(function () { a._trigger("onFinishZoom") }) }) }, _zoomOut: function () { var a = this; a._zoom(-1, function () { a._refresh(function () { a._trigger("onFinishZoom") }) }) }, _zoomUntilVisible: function (a, b) { var d = this; a.isVisible ? b() : d._refresh(function () { a.isVisible ? b() : d._zoom(1, function () { d._zoomUntilVisible(a, b) }) }) }, _zoom: function (a, c) { var d = this; if (d._canZoom(a)) { d.isZooming = !0; d._trigger("onStartZoom"); d.currentZoomLevel += a; var e = d._getCurrentScrollPosition(), g = d._getNextZoomWidth(a), h = b.wellcome.timeline.currentIndex; d.contentElem.animate({ width: g }, { step: function () { var a; a = -1 != h ? d._getEventScrollPosition(h) : Math.floor(d._getContentWidth() * e); d._scrollToPosition(a); d._redraw(!0, !0) }, easing: "easeInOutCubic", duration: b.wellcome.timeline.provider.options.zoomAnimationDuration, complete: function () { d.isZooming = !1; d.hasZoomed = !0; d._redraw(!1, !1); c && c() } }) } }, _resize: function () { this.scrollElem.width(this.element.width() - parseInt(this.scrollElem.css("margin-left")) - parseInt(this.scrollElem.css("margin-right"))); this.contentElem.width(this.element.width()); this._redraw(!1, !1); this._refresh(null, !0) }, _redraw: function (a, b) { this._drawBackgroundEvents(); this._drawEvents(a, b); this._drawTicks(); this.scroll.refresh() }, _refresh: function (a, b) { var d = this; if (!b) if (d.hasZoomed) d.hasZoomed = !1; else { null === d.lastZoomLevel && (d.lastZoomLevel = d.currentZoomLevel); d._selectCurrentEvent(); a && a(); return } d._updateVisibleEvents(); d._setEventsZIndex(); d._updateVisibleTicks(); d._showVisibleEvents(function () { d._updateNavigationAvailability(); d._selectCurrentEvent(); d._trigger("onRefreshed"); a && a() }) }, _selectCurrentEvent: function () { this.eventsElem.find(".event").removeClass("highlighted"); this.timeElem.find(".tickEvent").removeClass("highlighted"); var a = this._getCurrentEvent(); a && (this._setEventToTop(a), a.elem.addClass("selected"), this._selectTickEvent(a)) }, _drawBackgroundEvents: function () { for (var a = this._getContentWidth(), b = 0, d = this.backgroundEvents.length; b < d; b++) { var e = this.backgroundEvents[b], g = Math.ceil(e.startPosition * a), h = Math.ceil(e.endPosition * a) - g; e.elem.css({ left: g + "px", width: h + "px" }); e.titleElem.ellipsisFill(e.Title) } }, _drawEvents: function (a, b) { for (var d = this._getContentWidth(), e = this._getScrollWidth(), g = 0, h = this.events.length; g < h; g++) { var j = this.events[g], l = Math.ceil(j.position * d); j.leftPos = l; if (!b || j.isVisible) { if (a) { var m = -1 * this.scroll.x; if (l < m - 300 || l > m + e) { j.clipped || j.elem.css({ left: "-300px" }); j.clipped = !0; continue } } j.clipped = !1; j.top || (j.top = j.elem.outerHeight(!0) * j.stackLevel); j.elem.css({ left: l + "px", top: j.top }); j.lineHeight || (l = j.elem.find(".line"), j.lineHeight = this.eventsElem.height() - j.top - parseInt(j.elem.css("margin-top")) - parseInt(j.elem.height()) - (j.isPresent ? 9 : 7), l.height(j.lineHeight)) } } }, _drawTicks: function () { var a = this._getContentWidth(), c; c = a / this.centuries <= b.wellcome.timeline.provider.options.maxCenturyIntervalWidth ? this.centuryTicks : a / this.decades <= b.wellcome.timeline.provider.options.maxDecadeIntervalWidth ? this.decadeTicks : this.years < b.wellcome.timeline.provider.options.maxTicks ? this.yearTicks : this.decadeTicks; if (c !== this.currentTicks) switch (null != this.currentTicks && this.currentTicks.elem.hide(), this.currentTicks = c, c) { case this.yearTicks: this.yearTicks.elem.show(); break; case this.decadeTicks: this.decadeTicks.elem.show(); break; case this.centuryTicks: this.centuryTicks.elem.show() } a /= c.ticks.length; this.tickMargin || (this.tickMargin = parseInt(c.elem.find(".tick").first().css("margin-left"))); for (var a = a - this.tickMargin, d = 0, e = c.ticks.length; d < e; d++) c.ticks[d].elem.width(a) }, _isMaxZoom: function () { return !this._canZoom(1) ? !0 : !1 }, _isMinZoom: function () { return !this._canZoom(-1) ? !0 : !1 }, _getCurrentScrollPosition: function () { return normalise(this.scroll.x, 0, this._getContentWidth()) }, _scrollToPosition: function (a) { var b = -1 * (this._getContentWidth() - this._getScrollWidth()); a = clamp(a, b, 0); this.scroll.scrollTo(a, 0) }, _getEventScrollPosition: function (a) { return -1 * Math.floor(this.events[a].position * this._getContentWidth() - this._getScrollWidth() / 2 + 100) }, _highlightEvent: function (a) { this.isZooming || (a = this.events[a], a.elem.addClass("highlighted"), this._getTickEventElem(a).addClass("highlighted"), this._isMaxZoom() && this._setEventToTop(a)) }, _unhighlightEvent: function (a) { this.isZooming || (a = this.events[a], a.elem.removeClass("highlighted"), this._getTickEventElem(a).removeClass("highlighted"), this._isMaxZoom() && (this._setEventZIndex(a), this._getCurrentEvent() && this._setEventToTop(this._getCurrentEvent()))) }, _getNextZoomWidth: function (a) { var c = this.contentElem.width(); a = Math.pow(b.wellcome.timeline.provider.options.zoomFactor, a); return c * a }, _canZoom: function (a) { a = this._getNextZoomWidth(a); return a < this.scrollElem.width() || a > this._getMaxWidth() ? !1 : !0 }, _getMaxWidth: function () { var a = b.wellcome.timeline.provider.options.maxYearIntervalWidth, c = b.wellcome.timeline.provider.options.maxDecadeIntervalWidth; return this.years > b.wellcome.timeline.provider.options.maxTicks ? c * this.decades : a * this.years }, _getContentWidth: function () { return this.contentElem.width() }, _getScrollWidth: function () { return this.scrollElem.width() }, _getDecade: function (a) { return 10 * Math.floor(a.year() / 10) }, _getCentury: function (a) { return 100 * Math.floor(a.year() / 100) }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_footerPanelView", { _create: function () { var a = this; b.wellcome.timeline.bind(b.wellcome.timeline.TOGGLE_FULLSCREEN, function (b, d) { a._toggleFullScreen(d) }); a.optionsContainerElem = b('<div class="options"></div>'); a.element.append(a.optionsContainerElem); a.embedButtonElem = b('<a class="imageButton embed"></a>'); a.optionsContainerElem.append(a.embedButtonElem); a.fullScreenButtonElem = b('<a class="imageButton fullScreen"></a>'); a.optionsContainerElem.append(a.fullScreenButtonElem); a.fullScreenButtonElem.click(function (b) { b.preventDefault(); a._trigger("onToggleFullScreen") }); a.embedButtonElem.click(function (b) { b.preventDefault(); a._trigger("onEmbed") }); b.wellcome.timeline.isEmbedEnabled() || a.embedButtonElem.hide() }, _toggleFullScreen: function (a) { a ? (this.fullScreenButtonElem.removeClass("fullScreen"), this.fullScreenButtonElem.addClass("normal")) : (this.fullScreenButtonElem.removeClass("normal"), this.fullScreenButtonElem.addClass("fullScreen")) }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_baseDialogueView", { _create: function () { var a = this; a.isActive = !1; a.allowClose = !0; b.wellcome.timeline.bind(b.wellcome.timeline.RESIZE, function () { a._resize() }); b.wellcome.timeline.bind(b.wellcome.timeline.ESCAPE, function () { a.isActive && a.allowClose && a.close() }); b.wellcome.timeline.bind(b.wellcome.timeline.CLOSE_ACTIVE_DIALOGUE, function () { a.isActive && a.allowClose && a.close() }); a.topElem = b('<div class="top"></div>'); a.element.append(a.topElem); a.closeButtonElem = b('<div class="close"></div>'); a.topElem.append(a.closeButtonElem); a.middleElem = b('<div class="middle"></div>'); a.element.append(a.middleElem); a.contentElem = b('<div class="content"></div>'); a.middleElem.append(a.contentElem); a.bottomElem = b('<div class="bottom"></div>'); a.element.append(a.bottomElem); a.closeButtonElem.click(function (b) { b.preventDefault(); a.close() }) }, enableClose: function () { this.allowClose = !0; this.closeButtonElem.show() }, disableClose: function () { this.allowClose = !1; this.closeButtonElem.hide() }, setArrowPosition: function () { var a = parseInt(this.element.css("padding-left")), a = b.wellcome.timeline.mouseX - a - 10; 0 > a && (a = 0); this.bottomElem.css("backgroundPosition", a + "px 0px") }, open: function () { this.element.show(); this.setArrowPosition(); this.isActive = !0 }, close: function () { this.isActive && (this.element.hide(), this.isActive = !1, this._trigger("onClose")) }, _resize: function () { }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_genericDialogueView", { _create: function () { }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_embedView", b.wellcome.timeline_baseDialogueView, { embedScriptTemplate: '<div class="timeline" data-uri="{0}" data-eventid="{1}" style="width:{2}px; height:{3}px; background-color: #000"></div>\n<script type="text/javascript" src="{4}">\x3c/script><script type="text/javascript">/* wordpress fix */\x3c/script>', _create: function () { var a = this; b.wellcome.timeline_baseDialogueView.prototype._create.call(a); b.wellcome.timeline.bind(b.wellcome.timeline.SHOW_EMBED_DIALOGUE, function () { a.open() }); b.wellcome.timeline.bind(b.wellcome.timeline.HIDE_EMBED_DIALOGUE, function () { a.close() }); b.wellcome.timeline.bind(b.wellcome.timeline.REFRESHED, function () { a._refresh() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_INDEX_CHANGE, function () { a._refresh() }); a.smallWidth = 600; a.smallHeight = 600; a.mediumWidth = 800; a.mediumHeight = 600; a.largeWidth = 900; a.largeHeight = 900; a.currentWidth = a.smallWidth; a.currentHeight = a.smallHeight; a.titleElem = b("<h1>" + b.wellcome.timeline.options.config.EmbedView.Title + "</h1>"); a.contentElem.append(a.titleElem); a.introElem = b("<p>" + b.wellcome.timeline.options.config.EmbedView.EmbedInstructions + "</p>"); a.contentElem.append(a.introElem); a.codeElem = b('<textarea class="code"></textarea>'); a.contentElem.append(a.codeElem); a.copyToClipboardElem = b('<div class="copyToClipboard"></div>'); a.contentElem.append(a.copyToClipboardElem); a.sizesElem = b('<div class="sizes"></div>'); a.contentElem.append(a.sizesElem); a.smallSizeElem = b('<div class="size small"></div>'); a.sizesElem.append(a.smallSizeElem); a.smallSizeElem.append("<p>" + a.smallWidth + " x " + a.smallHeight + "</p>"); a.smallSizeElem.append('<div class="box"></div>'); a.mediumSizeElem = b('<div class="size medium"></div>'); a.sizesElem.append(a.mediumSizeElem); a.mediumSizeElem.append("<p>" + a.mediumWidth + " x " + a.mediumHeight + "</p>"); a.mediumSizeElem.append('<div class="box"></div>'); a.largeSizeElem = b('<div class="size large"></div>'); a.sizesElem.append(a.largeSizeElem); a.largeSizeElem.append("<p>" + a.largeWidth + " x " + a.largeHeight + "</p>"); a.largeSizeElem.append('<div class="box"></div>'); a.customSizeElem = b('<div class="size custom"></div>'); a.sizesElem.append(a.customSizeElem); a.customSizeElem.append("<p>Custom size</p>"); a.customSizeWrapElem = b('<div class="wrap"></div>'); a.customSizeElem.append(a.customSizeWrapElem); a.customSizeWidthWrapElem = b('<div class="width"></div>'); a.customSizeWrapElem.append(a.customSizeWidthWrapElem); a.customSizeWidthWrapElem.append('<label for="width">Width</label>'); a.customWidthElem = b('<input id="width" type="text" maxlength="5"></input>'); a.customSizeWidthWrapElem.append(a.customWidthElem); a.customSizeWidthWrapElem.append("<span>px</span>"); a.customSizeHeightWrapElem = b('<div class="height"></div>'); a.customSizeWrapElem.append(a.customSizeHeightWrapElem); a.customSizeHeightWrapElem.append('<label for="height">Height</label>'); a.customHeightElem = b('<input id="height" type="text" maxlength="5"></input>'); a.customSizeHeightWrapElem.append(a.customHeightElem); a.customSizeHeightWrapElem.append("<span>px</span>"); a.codeElem.focus(function () { b(this).select() }); a.codeElem.mouseup(function (a) { a.preventDefault() }); a.smallSizeElem.click(function (b) { b.preventDefault(); a.currentWidth = a.smallWidth; a.currentHeight = a.smallHeight; a._refresh() }); a.mediumSizeElem.click(function (b) { b.preventDefault(); a.currentWidth = a.mediumWidth; a.currentHeight = a.mediumHeight; a._refresh() }); a.largeSizeElem.click(function (b) { b.preventDefault(); a.currentWidth = a.largeWidth; a.currentHeight = a.largeHeight; a._refresh() }); a.smallSizeElem.addClass("selected"); a.sizesElem.find(".size").click(function (c) { c.preventDefault(); a.sizesElem.find(".size").removeClass("selected"); b(this).addClass("selected") }); a.customWidthElem.keydown(function (a) { numericalInput(a) }); a.customWidthElem.keyup(function () { a._getCustomSize() }); a.customHeightElem.keydown(function (a) { numericalInput(a) }); a.customHeightElem.keyup(function () { a._getCustomSize() }); a._refresh(); a.element.hide() }, _getCustomSize: function () { this.currentWidth = this.customWidthElem.val(); this.currentHeight = this.customHeightElem.val(); this._refresh() }, _refresh: function () { var a = b.wellcome.timeline.getCurrentEvent(), c = ""; a && (c = a.EventId); this.code = String.format(this.embedScriptTemplate, b.wellcome.timeline.options.dataUri, c, this.currentWidth, this.currentHeight, b.wellcome.timeline.options.embedScriptUri); this.codeElem.val(this.code) }, _resize: function () { }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery); (function (b) { b.widget("wellcome.timeline_detailsView", b.wellcome.timeline_baseDialogueView, { isCloseEnabled: !0, isPrevEnabled: !1, isNextEnabled: !1, isNavigating: !1, options: { maxWidth: 950 }, _create: function () { var a = this; b.wellcome.timeline_baseDialogueView.prototype._create.call(a); a.allowClose = !1; b.wellcome.timeline.bind(b.wellcome.timeline.START_ZOOM, function () { a._disableClose(); a._disablePrev(); a._disableNext() }); b.wellcome.timeline.bind(b.wellcome.timeline.FINISH_ZOOM, function () { a._refresh() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_NAVIGATING, function () { a.isNavigating = !0 }); b.wellcome.timeline.bind(b.wellcome.timeline.FINISH_NAVIGATING, function () { a.isNavigating = !1; a._refresh() }); b.wellcome.timeline.bind(b.wellcome.timeline.SHOW_EVENT_DETAILS_DIALOGUE, function () { a.open() }); b.wellcome.timeline.bind(b.wellcome.timeline.HIDE_EVENT_DETAILS_DIALOGUE, function () { a.close() }); b.wellcome.timeline.bind(b.wellcome.timeline.START_SCROLL, function (c, d) { a._disableClose(); a._disablePrev(); a._disableNext(); a._prepEvent(d, a.events[b.wellcome.timeline.currentIndex + 1]) }); b.wellcome.timeline.bind(b.wellcome.timeline.SCROLL_STEP, function (b, d) { a._scroll(parseInt(d.direction), d.pos) }); b.wellcome.timeline.bind(b.wellcome.timeline.FINISH_SCROLL, function () { a.currentDetailsElem = a.nextDetailsElem; a.centerColElem.find(".wrapper").not(a.currentDetailsElem).remove(); a.nextDetailsElem = null }); a.leftColElem = b('<div class="leftCol"></div>'); a.contentElem.append(a.leftColElem); a.prevBtnElem = b('<div class="prev"></div>'); a.leftColElem.append(a.prevBtnElem); a.centerColElem = b('<div class="centerCol"></div>'); a.contentElem.append(a.centerColElem); a.detailsTemplate = b('                <div class="wrapper">                    <div class="centerLeftCol"></div>                    <div class="centerRightCol">                        <div class="text"></div>                    </div>                </div>'); a.rightColElem = b('<div class="rightCol"></div>'); a.contentElem.append(a.rightColElem); a.nextBtnElem = b('<div class="next"></div>'); a.rightColElem.append(a.nextBtnElem); a.prevBtnElem.prop("title", b.wellcome.timeline.options.config.DetailsPanelView.Previous); a.nextBtnElem.prop("title", b.wellcome.timeline.options.config.DetailsPanelView.Next); a.prevBtnElem.on("click", function (c) { c.preventDefault(); a.isPrevEnabled && (0 == b.wellcome.timeline.currentIndex && (a._prepEvent(-1, a.events[0]), b({ val: 0 }).animate({ val: 1 }, { duration: 500, easing: "easeInOutCubic", step: function () { a._scroll(1, this.val) }, complete: function () { a.currentDetailsElem = a.nextDetailsElem; a._refresh() } })), a._trigger("onSelectPrev"), trackEvent("Timeline Interaction", "Prev", "", "")) }); a.nextBtnElem.on("click", function (b) { b.preventDefault(); a.isNextEnabled && (a._trigger("onSelectNext"), trackEvent("Timeline Interaction", "Next", "", "")) }); a.closeButtonElem.off("click").on("click", function (b) { b.preventDefault(); a.isCloseEnabled && a.close() }); a.events = b.wellcome.timeline.provider.data.Events.slice(); a.events.unshift(b.wellcome.timeline.provider.data); a._prepEvent(0, a.events[0]); a.currentDetailsElem = a.nextDetailsElem; a._refresh(); a.open() }, _refresh: function () { if (!this.isNavigating) { this.currentDetailsElem.css("left", 0); var a = b.wellcome.timeline.currentIndex; this._enableClose(); -1 == a ? this._disablePrev() : this._enablePrev(); var c = b.wellcome.timeline.provider.data.Events.length; b.wellcome.timeline.provider.data.Events[c - 1].isPresent && (c -= 1); a == c - 1 ? this._disableNext() : this._enableNext() } }, _resize: function () { var a = b(window), c = a.width() - parseInt(this.element.css("margin-left")) - parseInt(this.element.css("margin-right")); c > this.options.maxWidth && (c = this.options.maxWidth); this.element.width(c); this.element.css({ left: a.width() / 2 - this.element.outerWidth(!0) / 2 }); a = Math.floor(c - this.leftColElem.outerWidth() - this.rightColElem.outerWidth()); this.centerColElem.width(a); this.centerColElem.find(".wrapper").width(a); var a = Math.floor(this.centerLeftColElem.outerWidth(!0)), a = Math.floor(this.centerColElem.width() - a), c = Math.floor(parseInt(this.centerRightColElem.css("margin-left"))), d = Math.floor(parseInt(this.centerRightColElem.css("margin-right"))); this.centerRightColElem.width(a - (c + d) - 10) }, _prepEvent: function (a, c) { this.nextDetailsElem = this.detailsTemplate.clone(); var d = this.nextDetailsElem.find(".centerLeftCol"), e = b("<img />"); c.FeatureImagePath ? e.prop("src", c.FeatureImagePath) : e.prop("src", b.wellcome.timeline.provider.data.FeatureImagePath); d.append(e); var d = this.nextDetailsElem.find(".text"), e = b("<header></header>"), g = "<h1>" + c.Title + "</h1>"; if (c.StartDisplay) { var h = c.StartDisplay; c.EndDisplay && (h += " - " + c.EndDisplay); g += "<h2>" + h + "</h2>" } e.html(g); d.append(e); g = b("<section></section>"); g.html(c.Body); c.LinkText && c.LinkTarget && g.append('<p><a class="action" href="' + c.LinkTarget + '">' + c.LinkText + "</a></p>"); c.ImageCredit && g.append("<p><em>" + c.ImageCredit + "</em></p>"); g.find("a").prop("target", "_blank"); d.append(e); d.append(g); this.centerColElem.append(this.nextDetailsElem); this.currentDetailsElem && this.nextDetailsElem.css("left", this.nextDetailsElem.width() * a); this.centerLeftColElem = this.nextDetailsElem.find(".centerLeftCol"); this.centerRightColElem = this.nextDetailsElem.find(".centerRightCol"); this._resize() }, _scroll: function (a, b) { if (this.currentDetailsElem) { var d = this.contentElem.width() * a; this.currentDetailsElem.css("left", d * b); d = this.contentElem.width() * (-1 * a) * (1 - b); this.nextDetailsElem.css("left", d) } }, _disableClose: function () { this.isCloseEnabled = !1; this.closeButtonElem.addClass("disabled") }, _enableClose: function () { this.isCloseEnabled = !0; this.closeButtonElem.removeClass("disabled") }, _disablePrev: function () { this.isPrevEnabled = !1; this.prevBtnElem.addClass("disabled") }, _enablePrev: function () { this.isPrevEnabled = !0; this.prevBtnElem.removeClass("disabled") }, _disableNext: function () { this.isNextEnabled = !1; this.nextBtnElem.addClass("disabled") }, _enableNext: function () { this.isNextEnabled = !0; this.nextBtnElem.removeClass("disabled") }, _init: function () { }, _destroy: function () { b.Widget.prototype.destroy.apply(this, arguments) } }) })(jQuery);
